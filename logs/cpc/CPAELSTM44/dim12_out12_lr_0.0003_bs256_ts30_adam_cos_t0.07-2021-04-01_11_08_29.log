2021-04-01 11:08:29,370 - ===> use benchmark strategy to split train, validation and eval dataset
2021-04-01 11:08:30,888 - ### Model summary below###
 CPAELSTM44(
  (lstm1): LSTM(76, 12, batch_first=True)
  (lstm2): LSTM(12, 12, batch_first=True)
  (lstm3): LSTM(12, 12, batch_first=True)
  (dropout): Dropout(p=0.3, inplace=False)
  (softmax): Softmax(dim=0)
  (lsoftmax): LogSoftmax()
  (fcs): Sequential(
    (0): Linear(in_features=12, out_features=12, bias=True)
    (1): ReLU(inplace=True)
    (2): Linear(in_features=12, out_features=12, bias=True)
  )
  (lstm4): LSTM(12, 76, batch_first=True)
)

2021-04-01 11:08:30,888 - ===> Model total parameter: 34488

2021-04-01 11:08:30,889 - {'data_split': 'benchmark', 'batch_size': 256, 'mode': 0, 'dim': 12, 'bn': False, 'dropout': 0.3, 'task': 'ihm', 'learning_rate': 0.0003, 'epochs': 1000, 'seed': 1, 'log_interval': 5, 'num_workers': 30, 'gru_out': 12, 'sim': 'cosine', 'temperature': 0.07, 'optimizer': 'optim.Adam(filter(lambda p: p.requires_grad, model.parameters()), lr=0.0003, betas=(0.9, 0.98), eps=1e-09,weight_decay=1e-4)', 'adjust_lr': True, 'setting_name': 'dim12_out12_lr_0.0003_bs256_ts30_adam_cos_t0.07', 'run_name': 'dim12_out12_lr_0.0003_bs256_ts30_adam_cos_t0.07-2021-04-01_11_08_29', 'model_type': 'CPAELSTM44', 'resume': False, 'model_best': 'dim12_out12_lr_0.0003_bs256_ts30_adam_cos_t0.07-2021-04-01_11_04_19-model_best.pth', 'save_every': 100, 'lambda': [1, 1, 1, 3], 'time_step': 30, 'sym': False, 'top_path': '/home/shuying/CPAE/', 'scr_data_path': '/home/shuying/cpcSurvival/data', 'logging_dir': '/home/shuying/CPAE/logs/cpc/CPAELSTM44', 'ini_file': '/home/shuying/CPAE/logs/cpc/CPAELSTM44/dim12_out12_lr_0.0003_bs256_ts30_adam_cos_t0.07.ini', 'updated_lr': 0.0003}
2021-04-01 11:08:30,889 - 
 --------------------------- epoch 1 ------------------------- 

2021-04-01 11:08:30,889 - weights are [1, 1, 1, 3]
2021-04-01 11:08:48,782 - 	 31.72991 0.00030
2021-04-01 11:10:49,257 - 
 ---------------------- mean loss : 29.69696  ---------------------- 

2021-04-01 11:10:49,258 - Starting Validation
2021-04-01 11:11:06,408 - 
                     ------- validation -------            

2021-04-01 11:11:06,408 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 11:11:06,408 - 	 5.5041  	 0.2369  	 0.1122 	 0.5492
2021-04-01 11:11:06,408 - -------------------------------
Validation Epoch: 1 	Accuracy: 13.0000	Loss: 378.039997
------------------
2021-04-01 11:11:06,412 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44/dim12_out12_lr_0.0003_bs256_ts30_adam_cos_t0.07-2021-04-01_11_08_29-model_best.pth

2021-04-01 11:11:06,412 - Best model updated in 'dim12_out12_lr_0.0003_bs256_ts30_adam_cos_t0.07.ini'! !!!!!!!!!
2021-04-01 11:11:06,412 - #### End epoch 1/1000, elapsed time: 155.52390948869288
2021-04-01 11:11:06,413 - 
 --------------------------- epoch 2 ------------------------- 

2021-04-01 11:11:06,413 - weights are [1, 1, 1, 3]
2021-04-01 11:11:24,551 - 	 28.43814 0.00030
2021-04-01 11:13:21,553 - 
 ---------------------- mean loss : 30.57697  ---------------------- 

2021-04-01 11:13:21,554 - Starting Validation
2021-04-01 11:13:39,286 - 
                     ------- validation -------            

2021-04-01 11:13:39,286 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 11:13:39,286 - 	 5.5041  	 0.2405  	 0.1035 	 0.5992
2021-04-01 11:13:39,286 - -------------------------------
Validation Epoch: 2 	Accuracy: 13.0000	Loss: 379.162819
------------------
2021-04-01 11:13:39,286 - #### End epoch 2/1000, elapsed time: 152.87358689215034
2021-04-01 11:13:39,286 - 
 --------------------------- epoch 3 ------------------------- 

2021-04-01 11:13:39,286 - weights are [1, 1, 1, 3]
2021-04-01 11:14:04,975 - 	 28.43277 0.00030
2021-04-01 11:15:59,775 - 
 ---------------------- mean loss : 30.65692  ---------------------- 

2021-04-01 11:15:59,775 - Starting Validation
2021-04-01 11:16:18,797 - 
                     ------- validation -------            

2021-04-01 11:16:18,808 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 11:16:18,808 - 	 5.5041  	 0.2129  	 0.1024 	 0.4883
2021-04-01 11:16:18,808 - -------------------------------
Validation Epoch: 3 	Accuracy: 13.0000	Loss: 375.889194
------------------
2021-04-01 11:16:18,808 - #### End epoch 3/1000, elapsed time: 159.522045917809
2021-04-01 11:16:18,809 - 
 --------------------------- epoch 4 ------------------------- 

2021-04-01 11:16:18,809 - weights are [1, 1, 1, 3]
2021-04-01 11:16:37,568 - 	 28.41236 0.00030
2021-04-01 11:18:31,076 - 
 ---------------------- mean loss : 30.10606  ---------------------- 

2021-04-01 11:18:31,077 - Starting Validation
2021-04-01 11:18:48,880 - 
                     ------- validation -------            

2021-04-01 11:18:48,881 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 11:18:48,881 - 	 5.5041  	 0.2080  	 0.1021 	 0.4711
2021-04-01 11:18:48,881 - -------------------------------
Validation Epoch: 4 	Accuracy: 13.0000	Loss: 375.369659
------------------
2021-04-01 11:18:48,881 - #### End epoch 4/1000, elapsed time: 150.07262802310288
2021-04-01 11:18:48,881 - 
 --------------------------- epoch 5 ------------------------- 

2021-04-01 11:18:48,881 - weights are [1, 1, 1, 3]
2021-04-01 11:19:06,258 - 	 28.87426 0.00030
2021-04-01 11:21:41,570 - 
 ---------------------- mean loss : 30.09219  ---------------------- 

2021-04-01 11:21:41,570 - Starting Validation
2021-04-01 11:22:00,180 - 
                     ------- validation -------            

2021-04-01 11:22:00,181 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 11:22:00,181 - 	 5.5041  	 0.2710  	 0.1013 	 0.7194
2021-04-01 11:22:00,181 - -------------------------------
Validation Epoch: 5 	Accuracy: 13.0000	Loss: 382.624966
------------------
2021-04-01 11:22:00,181 - #### End epoch 5/1000, elapsed time: 191.30001615919173
2021-04-01 11:22:00,181 - 
 --------------------------- epoch 6 ------------------------- 

2021-04-01 11:22:00,181 - weights are [1, 1, 1, 3]
2021-04-01 11:22:20,566 - 	 28.36823 0.00030
2021-04-01 11:24:54,593 - 
 ---------------------- mean loss : 30.10759  ---------------------- 

2021-04-01 11:24:54,595 - Starting Validation
2021-04-01 11:25:14,260 - 
                     ------- validation -------            

2021-04-01 11:25:14,260 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 11:25:14,260 - 	 5.5041  	 0.2427  	 0.1009 	 0.6409
2021-04-01 11:25:14,260 - -------------------------------
Validation Epoch: 6 	Accuracy: 13.0000	Loss: 380.204073
------------------
2021-04-01 11:25:14,260 - #### End epoch 6/1000, elapsed time: 194.07938085962087
2021-04-01 11:25:14,261 - 
 --------------------------- epoch 7 ------------------------- 

2021-04-01 11:25:14,261 - weights are [1, 1, 1, 3]
2021-04-01 11:25:33,274 - 	 29.75586 0.00030
2021-04-01 11:28:02,557 - 
 ---------------------- mean loss : 30.08697  ---------------------- 

2021-04-01 11:28:02,557 - Starting Validation
2021-04-01 11:28:24,356 - 
                     ------- validation -------            

2021-04-01 11:28:24,356 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 11:28:24,356 - 	 5.5041  	 0.2151  	 0.1002 	 0.5089
2021-04-01 11:28:24,356 - -------------------------------
Validation Epoch: 7 	Accuracy: 13.0000	Loss: 376.393625
------------------
2021-04-01 11:28:24,356 - #### End epoch 7/1000, elapsed time: 190.0955527694896
2021-04-01 11:28:24,356 - 
 --------------------------- epoch 8 ------------------------- 

2021-04-01 11:28:24,356 - weights are [1, 1, 1, 3]
2021-04-01 11:28:42,689 - 	 28.32225 0.00030
