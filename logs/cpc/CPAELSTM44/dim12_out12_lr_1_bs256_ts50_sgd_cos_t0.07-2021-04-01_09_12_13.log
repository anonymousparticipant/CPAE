2021-04-01 09:12:13,095 - ===> use benchmark strategy to split train, validation and eval dataset
2021-04-01 09:12:14,378 - ### Model summary below###
 CPAELSTM44(
  (lstm1): LSTM(76, 12, batch_first=True)
  (lstm2): LSTM(12, 12, batch_first=True)
  (lstm3): LSTM(12, 12, batch_first=True)
  (dropout): Dropout(p=0.3, inplace=False)
  (softmax): Softmax(dim=0)
  (lsoftmax): LogSoftmax()
  (fcs): Sequential(
    (0): Linear(in_features=12, out_features=12, bias=True)
    (1): ReLU(inplace=True)
    (2): Linear(in_features=12, out_features=12, bias=True)
  )
  (lstm4): LSTM(12, 76, batch_first=True)
)

2021-04-01 09:12:14,379 - ===> Model total parameter: 34488

2021-04-01 09:12:14,379 - {'data_split': 'benchmark', 'batch_size': 256, 'mode': 0, 'dim': 12, 'bn': False, 'dropout': 0.3, 'task': 'ihm', 'learning_rate': 0.03, 'epochs': 1000, 'seed': 1, 'log_interval': 30, 'num_workers': 30, 'gru_out': 12, 'sim': 'cosine', 'temperature': 0.07, 'optimizer': 'optim.SGD(filter(lambda p: p.requires_grad,model.parameters()), lr=0.03, momentum=0.9, weight_decay=1e-4)', 'adjust_lr': True, 'setting_name': 'dim12_out12_lr_1_bs256_ts50_sgd_cos_t0.07', 'run_name': 'dim12_out12_lr_1_bs256_ts50_sgd_cos_t0.07-2021-04-01_09_12_13', 'model_type': 'CPAELSTM44', 'resume': False, 'model_best': 'dim12_out12_lr_1_bs128_ts50-2021-03-27_20_11_04-model_best.pth', 'save_every': 100, 'lambda': [1, 1, 1, 3], 'time_step': 50, 'sym': False, 'top_path': '/home/shuying/CPAE/', 'scr_data_path': '/home/shuying/cpcSurvival/data', 'logging_dir': '/home/shuying/CPAE/logs/cpc/CPAELSTM44', 'ini_file': '/home/shuying/CPAE/logs/cpc/CPAELSTM44/dim12_out12_lr_1_bs256_ts50_sgd_cos_t0.07.ini'}
2021-04-01 09:12:14,379 - 
 --------------------------- epoch 1 ------------------------- 

2021-04-01 09:12:14,379 - weights are [1, 1, 1, 3]
2021-04-01 09:12:25,671 - 	 78.56944 0.03000
2021-04-01 09:13:19,687 - 
 ---------------------- mean loss : 30.07237  ---------------------- 

2021-04-01 09:13:19,689 - Starting Validation
2021-04-01 09:13:32,792 - 
                     ------- validation -------            

2021-04-01 09:13:32,793 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:13:32,793 - 	 5.5041  	 0.2282  	 0.1042 	 0.5465
2021-04-01 09:13:32,793 - -------------------------------
Validation Epoch: 1 	Accuracy: 13.0000	Loss: 377.649775
------------------
2021-04-01 09:13:32,796 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44/dim12_out12_lr_1_bs256_ts50_sgd_cos_t0.07-2021-04-01_09_12_13-model_best.pth

2021-04-01 09:13:32,797 - Best model updated in 'dim12_out12_lr_1_bs256_ts50_sgd_cos_t0.07.ini'! !!!!!!!!!
2021-04-01 09:13:32,797 - #### End epoch 1/1000, elapsed time: 78.41813655290753
2021-04-01 09:13:32,797 - 
 --------------------------- epoch 2 ------------------------- 

2021-04-01 09:13:32,797 - weights are [1, 1, 1, 3]
2021-04-01 09:13:43,838 - 	 30.68554 0.03000
2021-04-01 09:14:37,292 - 
 ---------------------- mean loss : 30.24825  ---------------------- 

2021-04-01 09:14:37,293 - Starting Validation
2021-04-01 09:14:50,666 - 
                     ------- validation -------            

2021-04-01 09:14:50,666 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:14:50,666 - 	 5.5041  	 0.2169  	 0.1017 	 0.5144
2021-04-01 09:14:50,666 - -------------------------------
Validation Epoch: 2 	Accuracy: 13.0000	Loss: 376.604038
------------------
2021-04-01 09:14:50,666 - #### End epoch 2/1000, elapsed time: 77.86961154639721
2021-04-01 09:14:50,667 - 
 --------------------------- epoch 3 ------------------------- 

2021-04-01 09:14:50,667 - weights are [1, 1, 1, 3]
2021-04-01 09:15:05,245 - 	 28.44459 0.03000
2021-04-01 09:16:21,257 - 
 ---------------------- mean loss : 29.64780  ---------------------- 

2021-04-01 09:16:21,257 - Starting Validation
2021-04-01 09:16:36,663 - 
                     ------- validation -------            

2021-04-01 09:16:36,663 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:16:36,663 - 	 5.5041  	 0.2441  	 0.1026 	 0.6429
2021-04-01 09:16:36,663 - -------------------------------
Validation Epoch: 3 	Accuracy: 13.0000	Loss: 380.321468
------------------
2021-04-01 09:16:36,663 - #### End epoch 3/1000, elapsed time: 105.99660754390061
2021-04-01 09:16:36,663 - 
 --------------------------- epoch 4 ------------------------- 

2021-04-01 09:16:36,663 - weights are [1, 1, 1, 3]
2021-04-01 09:16:49,094 - 	 28.51768 0.03000
2021-04-01 09:18:18,461 - 
 ---------------------- mean loss : 30.26220  ---------------------- 

2021-04-01 09:18:18,465 - Starting Validation
2021-04-01 09:18:32,657 - 
                     ------- validation -------            

2021-04-01 09:18:32,657 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:18:32,657 - 	 5.5041  	 0.2443  	 0.1017 	 0.6307
2021-04-01 09:18:32,657 - -------------------------------
Validation Epoch: 4 	Accuracy: 13.0000	Loss: 379.981533
------------------
2021-04-01 09:18:32,657 - #### End epoch 4/1000, elapsed time: 115.99425109103322
2021-04-01 09:18:32,658 - 
 --------------------------- epoch 5 ------------------------- 

2021-04-01 09:18:32,658 - weights are [1, 1, 1, 3]
2021-04-01 09:18:47,620 - 	 56.30617 0.03000
2021-04-01 09:19:38,641 - 
 ---------------------- mean loss : 29.89252  ---------------------- 

2021-04-01 09:19:38,647 - Starting Validation
2021-04-01 09:19:51,995 - 
                     ------- validation -------            

2021-04-01 09:19:51,995 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:19:51,995 - 	 5.5041  	 0.2167  	 0.1017 	 0.5296
2021-04-01 09:19:51,995 - -------------------------------
Validation Epoch: 5 	Accuracy: 13.0000	Loss: 376.992533
------------------
2021-04-01 09:19:51,995 - #### End epoch 5/1000, elapsed time: 79.33798358868808
2021-04-01 09:19:51,996 - 
 --------------------------- epoch 6 ------------------------- 

2021-04-01 09:19:51,996 - weights are [1, 1, 1, 3]
2021-04-01 09:20:07,108 - 	 28.41825 0.03000
2021-04-01 09:20:59,527 - 
 ---------------------- mean loss : 29.84485  ---------------------- 

2021-04-01 09:20:59,527 - Starting Validation
2021-04-01 09:21:13,459 - 
                     ------- validation -------            

2021-04-01 09:21:13,459 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:21:13,459 - 	 5.5041  	 0.2476  	 0.1013 	 0.6618
2021-04-01 09:21:13,459 - -------------------------------
Validation Epoch: 6 	Accuracy: 13.0000	Loss: 380.823660
------------------
2021-04-01 09:21:13,460 - #### End epoch 6/1000, elapsed time: 81.46406598202884
2021-04-01 09:21:13,460 - 
 --------------------------- epoch 7 ------------------------- 

2021-04-01 09:21:13,460 - weights are [1, 1, 1, 3]
2021-04-01 09:21:28,555 - 	 28.49660 0.03000
2021-04-01 09:22:20,576 - 
 ---------------------- mean loss : 29.60099  ---------------------- 

2021-04-01 09:22:20,578 - Starting Validation
2021-04-01 09:22:33,954 - 
                     ------- validation -------            

2021-04-01 09:22:33,955 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:22:33,955 - 	 5.5041  	 0.2296  	 0.1018 	 0.5865
2021-04-01 09:22:33,955 - -------------------------------
Validation Epoch: 7 	Accuracy: 13.0000	Loss: 378.643700
------------------
2021-04-01 09:22:33,955 - #### End epoch 7/1000, elapsed time: 80.49526398535818
2021-04-01 09:22:33,955 - 
 --------------------------- epoch 8 ------------------------- 

2021-04-01 09:22:33,955 - weights are [1, 1, 1, 3]
2021-04-01 09:22:45,061 - 	 28.44684 0.03000
2021-04-01 09:23:38,769 - 
 ---------------------- mean loss : 29.87803  ---------------------- 

2021-04-01 09:23:38,771 - Starting Validation
2021-04-01 09:23:52,070 - 
                     ------- validation -------            

2021-04-01 09:23:52,070 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:23:52,070 - 	 5.5041  	 0.2378  	 0.1016 	 0.6045
2021-04-01 09:23:52,070 - -------------------------------
Validation Epoch: 8 	Accuracy: 13.0000	Loss: 379.213797
------------------
2021-04-01 09:23:52,071 - #### End epoch 8/1000, elapsed time: 78.11564863659441
2021-04-01 09:23:52,071 - 
 --------------------------- epoch 9 ------------------------- 

2021-04-01 09:23:52,071 - weights are [1, 1, 1, 3]
2021-04-01 09:24:03,218 - 	 28.54958 0.03000
2021-04-01 09:24:58,839 - 
 ---------------------- mean loss : 29.73649  ---------------------- 

2021-04-01 09:24:58,841 - Starting Validation
2021-04-01 09:25:11,852 - 
                     ------- validation -------            

2021-04-01 09:25:11,852 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:25:11,852 - 	 5.5041  	 0.2613  	 0.1034 	 0.7219
2021-04-01 09:25:11,852 - -------------------------------
Validation Epoch: 9 	Accuracy: 13.0000	Loss: 382.618889
------------------
2021-04-01 09:25:11,852 - #### End epoch 9/1000, elapsed time: 79.78180517721921
2021-04-01 09:25:11,853 - 
 --------------------------- epoch 10 ------------------------- 

2021-04-01 09:25:11,853 - weights are [1, 1, 1, 3]
2021-04-01 09:25:26,886 - 	 28.46358 0.03000
2021-04-01 09:26:19,684 - 
 ---------------------- mean loss : 30.19770  ---------------------- 

2021-04-01 09:26:19,685 - Starting Validation
2021-04-01 09:26:33,397 - 
                     ------- validation -------            

2021-04-01 09:26:33,397 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:26:33,398 - 	 5.5041  	 0.2341  	 0.1014 	 0.5932
2021-04-01 09:26:33,398 - -------------------------------
Validation Epoch: 10 	Accuracy: 13.0000	Loss: 378.868355
------------------
2021-04-01 09:26:33,398 - #### End epoch 10/1000, elapsed time: 81.54525086004287
2021-04-01 09:26:33,398 - 
 --------------------------- epoch 11 ------------------------- 

2021-04-01 09:26:33,398 - weights are [1, 1, 1, 3]
2021-04-01 09:26:44,216 - 	 28.38967 0.03000
2021-04-01 09:27:38,660 - 
 ---------------------- mean loss : 29.64509  ---------------------- 

2021-04-01 09:27:38,662 - Starting Validation
2021-04-01 09:27:52,730 - 
                     ------- validation -------            

2021-04-01 09:27:52,730 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:27:52,730 - 	 5.5041  	 0.2222  	 0.1011 	 0.5347
2021-04-01 09:27:52,730 - -------------------------------
Validation Epoch: 11 	Accuracy: 13.0000	Loss: 377.181520
------------------
2021-04-01 09:27:52,730 - #### End epoch 11/1000, elapsed time: 79.33243213687092
2021-04-01 09:27:52,730 - 
 --------------------------- epoch 12 ------------------------- 

2021-04-01 09:27:52,731 - weights are [1, 1, 1, 3]
2021-04-01 09:28:01,568 - 	 29.03528 0.03000
2021-04-01 09:28:59,326 - 
 ---------------------- mean loss : 29.94065  ---------------------- 

2021-04-01 09:28:59,328 - Starting Validation
2021-04-01 09:29:13,010 - 
                     ------- validation -------            

2021-04-01 09:29:13,010 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:29:13,010 - 	 5.5041  	 0.2864  	 0.1050 	 0.8205
2021-04-01 09:29:13,010 - -------------------------------
Validation Epoch: 12 	Accuracy: 13.0000	Loss: 385.548752
------------------
2021-04-01 09:29:13,010 - #### End epoch 12/1000, elapsed time: 80.27979499846697
2021-04-01 09:29:13,010 - 
 --------------------------- epoch 13 ------------------------- 

2021-04-01 09:29:13,010 - weights are [1, 1, 1, 3]
2021-04-01 09:29:23,429 - 	 28.36043 0.03000
2021-04-01 09:30:18,705 - 
 ---------------------- mean loss : 29.55770  ---------------------- 

2021-04-01 09:30:18,705 - Starting Validation
2021-04-01 09:30:32,170 - 
                     ------- validation -------            

2021-04-01 09:30:32,170 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:30:32,170 - 	 5.5041  	 0.2277  	 0.1014 	 0.5835
2021-04-01 09:30:32,170 - -------------------------------
Validation Epoch: 13 	Accuracy: 13.0000	Loss: 378.531904
------------------
2021-04-01 09:30:32,170 - #### End epoch 13/1000, elapsed time: 79.16027085203677
2021-04-01 09:30:32,171 - 
 --------------------------- epoch 14 ------------------------- 

2021-04-01 09:30:32,171 - weights are [1, 1, 1, 3]
2021-04-01 09:30:43,268 - 	 28.40454 0.03000
2021-04-01 09:32:15,542 - 
 ---------------------- mean loss : 29.95951  ---------------------- 

2021-04-01 09:32:15,544 - Starting Validation
2021-04-01 09:32:31,662 - 
                     ------- validation -------            

2021-04-01 09:32:31,662 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:32:31,662 - 	 5.5040  	 0.2674  	 0.1018 	 0.7454
2021-04-01 09:32:31,662 - -------------------------------
Validation Epoch: 14 	Accuracy: 13.0000	Loss: 383.265213
------------------
2021-04-01 09:32:31,662 - #### End epoch 14/1000, elapsed time: 119.49161569681019
2021-04-01 09:32:31,662 - 
 --------------------------- epoch 15 ------------------------- 

2021-04-01 09:32:31,662 - weights are [1, 1, 1, 3]
2021-04-01 09:32:47,357 - 	 28.33782 0.03000
2021-04-01 09:34:50,544 - 
 ---------------------- mean loss : 30.04997  ---------------------- 

2021-04-01 09:34:50,546 - Starting Validation
2021-04-01 09:35:13,661 - 
                     ------- validation -------            

2021-04-01 09:35:13,662 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:35:13,662 - 	 5.5040  	 0.2155  	 0.1012 	 0.5228
2021-04-01 09:35:13,662 - -------------------------------
Validation Epoch: 15 	Accuracy: 13.0000	Loss: 376.786770
------------------
2021-04-01 09:35:13,662 - #### End epoch 15/1000, elapsed time: 161.9997252272442
2021-04-01 09:35:13,662 - 
 --------------------------- epoch 16 ------------------------- 

2021-04-01 09:35:13,662 - weights are [1, 1, 1, 3]
2021-04-01 09:35:23,837 - 	 28.50925 0.03000
2021-04-01 09:37:35,600 - 
 ---------------------- mean loss : 30.12758  ---------------------- 

2021-04-01 09:37:35,600 - Starting Validation
2021-04-01 09:37:52,911 - 
                     ------- validation -------            

2021-04-01 09:37:52,911 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:37:52,912 - 	 5.5040  	 0.2087  	 0.1015 	 0.4928
2021-04-01 09:37:52,912 - -------------------------------
Validation Epoch: 16 	Accuracy: 13.0000	Loss: 375.922756
------------------
2021-04-01 09:37:52,912 - #### End epoch 16/1000, elapsed time: 159.24985187035054
2021-04-01 09:37:52,912 - 
 --------------------------- epoch 17 ------------------------- 

2021-04-01 09:37:52,912 - weights are [1, 1, 1, 3]
2021-04-01 09:38:06,765 - 	 30.70777 0.03000
2021-04-01 09:40:23,673 - 
 ---------------------- mean loss : 29.99828  ---------------------- 

2021-04-01 09:40:23,675 - Starting Validation
2021-04-01 09:40:42,409 - 
                     ------- validation -------            

2021-04-01 09:40:42,409 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:40:42,409 - 	 5.5039  	 0.2089  	 0.1021 	 0.4733
2021-04-01 09:40:42,409 - -------------------------------
Validation Epoch: 17 	Accuracy: 13.0000	Loss: 375.430157
------------------
2021-04-01 09:40:42,409 - #### End epoch 17/1000, elapsed time: 169.49772152677178
2021-04-01 09:40:42,410 - 
 --------------------------- epoch 18 ------------------------- 

2021-04-01 09:40:42,410 - weights are [1, 1, 1, 3]
2021-04-01 09:40:58,504 - 	 28.35847 0.03000
2021-04-01 09:43:02,935 - 
 ---------------------- mean loss : 29.67513  ---------------------- 

2021-04-01 09:43:02,935 - Starting Validation
2021-04-01 09:43:20,091 - 
                     ------- validation -------            

2021-04-01 09:43:20,092 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:43:20,092 - 	 5.5038  	 0.2258  	 0.1056 	 0.5578
2021-04-01 09:43:20,092 - -------------------------------
Validation Epoch: 18 	Accuracy: 13.0000	Loss: 377.931450
------------------
2021-04-01 09:43:20,092 - #### End epoch 18/1000, elapsed time: 157.6822825036943
2021-04-01 09:43:20,092 - 
 --------------------------- epoch 19 ------------------------- 

2021-04-01 09:43:20,092 - weights are [1, 1, 1, 3]
2021-04-01 09:43:36,863 - 	 36.86576 0.03000
2021-04-01 09:45:44,032 - 
 ---------------------- mean loss : 29.64082  ---------------------- 

2021-04-01 09:45:44,033 - Starting Validation
2021-04-01 09:46:01,347 - 
                     ------- validation -------            

2021-04-01 09:46:01,347 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:46:01,347 - 	 5.5035  	 0.2386  	 0.1020 	 0.6045
2021-04-01 09:46:01,347 - -------------------------------
Validation Epoch: 19 	Accuracy: 13.0000	Loss: 379.198313
------------------
2021-04-01 09:46:01,347 - #### End epoch 19/1000, elapsed time: 161.2555333264172
2021-04-01 09:46:01,348 - 
 --------------------------- epoch 20 ------------------------- 

2021-04-01 09:46:01,348 - weights are [1, 1, 1, 3]
2021-04-01 09:46:17,891 - 	 28.34743 0.03000
2021-04-01 09:48:25,905 - 
 ---------------------- mean loss : 30.35847  ---------------------- 

2021-04-01 09:48:25,908 - Starting Validation
2021-04-01 09:48:43,263 - 
                     ------- validation -------            

2021-04-01 09:48:43,264 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:48:43,267 - 	 5.5034  	 0.2147  	 0.1015 	 0.5023
2021-04-01 09:48:43,267 - -------------------------------
Validation Epoch: 20 	Accuracy: 13.0000	Loss: 376.214260
------------------
2021-04-01 09:48:43,267 - #### End epoch 20/1000, elapsed time: 161.91932470165193
2021-04-01 09:48:43,267 - 
 --------------------------- epoch 21 ------------------------- 

2021-04-01 09:48:43,267 - weights are [1, 1, 1, 3]
2021-04-01 09:48:58,797 - 	 28.29857 0.03000
