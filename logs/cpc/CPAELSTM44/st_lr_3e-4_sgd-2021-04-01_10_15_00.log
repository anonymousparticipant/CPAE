2021-04-01 10:15:00,180 - ===> use benchmark strategy to split train, validation and eval dataset
2021-04-01 10:15:01,532 - ### Model summary below###
 CPAELSTM44(
  (lstm1): LSTM(76, 256, batch_first=True)
  (lstm2): LSTM(256, 256, batch_first=True)
  (lstm3): LSTM(256, 256, batch_first=True)
  (dropout): Dropout(p=0.3, inplace=False)
  (softmax): Softmax(dim=0)
  (lsoftmax): LogSoftmax()
  (fcs): Sequential(
    (0): Linear(in_features=256, out_features=256, bias=True)
    (1): ReLU(inplace=True)
    (2): Linear(in_features=256, out_features=256, bias=True)
  )
  (lstm4): LSTM(256, 76, batch_first=True)
)

2021-04-01 10:15:01,532 - ===> Model total parameter: 1627808

2021-04-01 10:15:01,532 - {'data_split': 'benchmark', 'batch_size': 48, 'n_points': 192, 'n_features': 76, 'time_step': 30, 'mode': 0, 'points_per_hour': 4, 'frame_size': 16, 'n_frames': 12, 'dim': 256, 'bn': False, 'dropout': 0.3, 'task': 'ihm', 'learning_rate': 0.0003, 'epochs': 1000, 'seed': 1, 'log_interval': 30, 'num_workers': 30, 'gru_out': 256, 'optimizer': 'optim.SGD(filter(lambda p: p.requires_grad,model.parameters()), lr=0.0003, momentum=0.9, weight_decay=1e-4)', 'model_params': None, 'setting_name': 'st_lr_3e-4_sgd', 'run_name': 'st_lr_3e-4_sgd-2021-04-01_10_15_00', 'model_type': 'CPAELSTM44', 'resume': False, 'model_best': 'st_lr_1e-1_sgd-2021-04-01_09_58_46-model_best.pth', 'save_every': 100, 'lambda': [1, 1, 1, 3], 'top_path': '/home/shuying/CPAE/', 'scr_data_path': '/home/shuying/cpcSurvival/data', 'logging_dir': '/home/shuying/CPAE/logs/cpc/CPAELSTM44', 'ini_file': '/home/shuying/CPAE/logs/cpc/CPAELSTM44/st_lr_3e-4_sgd.ini', 'updated_lr': 0.1}
2021-04-01 10:15:01,532 - 
 --------------------------- epoch 1 ------------------------- 

2021-04-01 10:15:01,533 - weights are [1, 1, 1, 3]
2021-04-01 10:15:04,175 - 	 20.28458 0.00030
2021-04-01 10:15:34,195 - 	 20.18491 0.00030
2021-04-01 10:16:03,548 - 	 20.43661 0.00030
2021-04-01 10:16:47,326 - 	 20.54358 0.00030
2021-04-01 10:16:49,658 - 
 ---------------------- mean loss : 22.45466  ---------------------- 

2021-04-01 10:16:49,658 - Starting Validation
2021-04-01 10:17:07,494 - 
                     ------- validation -------            

2021-04-01 10:17:07,494 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:17:07,495 - 	 3.8406  	 0.3461  	 0.1300 	 1.0163
2021-04-01 10:17:07,495 - -------------------------------
Validation Epoch: 1 	Accuracy: 68.0000	Loss: 1485.244445
------------------
2021-04-01 10:17:07,507 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44/st_lr_3e-4_sgd-2021-04-01_10_15_00-model_best.pth

2021-04-01 10:17:07,507 - Best model updated in 'st_lr_3e-4_sgd.ini'! !!!!!!!!!
2021-04-01 10:17:07,508 - #### End epoch 1/1000, elapsed time: 125.97511865384877
2021-04-01 10:17:07,508 - 
 --------------------------- epoch 2 ------------------------- 

2021-04-01 10:17:07,508 - weights are [1, 1, 1, 3]
2021-04-01 10:17:10,802 - 	 20.28501 0.00030
2021-04-01 10:17:57,949 - 	 20.19325 0.00030
2021-04-01 10:18:44,726 - 	 20.24864 0.00030
2021-04-01 10:19:27,960 - 	 20.26941 0.00030
2021-04-01 10:19:31,796 - 
 ---------------------- mean loss : 22.31146  ---------------------- 

2021-04-01 10:19:31,796 - Starting Validation
2021-04-01 10:19:51,714 - 
                     ------- validation -------            

2021-04-01 10:19:51,714 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:19:51,715 - 	 3.8406  	 0.2469  	 0.1229 	 0.5662
2021-04-01 10:19:51,715 - -------------------------------
Validation Epoch: 2 	Accuracy: 68.0000	Loss: 1416.315411
------------------
2021-04-01 10:19:51,715 - #### End epoch 2/1000, elapsed time: 164.20713924895972
2021-04-01 10:19:51,715 - 
 --------------------------- epoch 3 ------------------------- 

2021-04-01 10:19:51,715 - weights are [1, 1, 1, 3]
2021-04-01 10:19:55,726 - 	 20.48114 0.00030
2021-04-01 10:20:43,894 - 	 20.41942 0.00030
2021-04-01 10:21:31,654 - 	 20.21521 0.00030
2021-04-01 10:22:18,512 - 	 20.29762 0.00030
2021-04-01 10:22:21,000 - 
 ---------------------- mean loss : 21.95025  ---------------------- 

2021-04-01 10:22:21,000 - Starting Validation
2021-04-01 10:22:39,499 - 
                     ------- validation -------            

2021-04-01 10:22:39,500 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:22:39,500 - 	 3.8406  	 0.2268  	 0.1188 	 0.4786
2021-04-01 10:22:39,500 - -------------------------------
Validation Epoch: 3 	Accuracy: 68.0000	Loss: 1402.475527
------------------
2021-04-01 10:22:39,500 - #### End epoch 3/1000, elapsed time: 167.78511686157435
2021-04-01 10:22:39,500 - 
 --------------------------- epoch 4 ------------------------- 

2021-04-01 10:22:39,500 - weights are [1, 1, 1, 3]
2021-04-01 10:22:46,198 - 	 20.13400 0.00030
2021-04-01 10:23:36,371 - 	 20.15054 0.00030
2021-04-01 10:24:22,451 - 	 20.13910 0.00030
2021-04-01 10:25:11,371 - 	 20.81598 0.00030
2021-04-01 10:25:13,747 - 
 ---------------------- mean loss : 22.14559  ---------------------- 

2021-04-01 10:25:13,747 - Starting Validation
2021-04-01 10:25:31,597 - 
                     ------- validation -------            

2021-04-01 10:25:31,597 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:25:31,598 - 	 3.8406  	 0.2963  	 0.1155 	 0.7858
2021-04-01 10:25:31,598 - -------------------------------
Validation Epoch: 4 	Accuracy: 68.0000	Loss: 1448.537162
------------------
2021-04-01 10:25:31,598 - #### End epoch 4/1000, elapsed time: 172.09776102006435
2021-04-01 10:25:31,598 - 
 --------------------------- epoch 5 ------------------------- 

2021-04-01 10:25:31,598 - weights are [1, 1, 1, 3]
2021-04-01 10:25:35,466 - 	 20.20506 0.00030
2021-04-01 10:26:23,569 - 	 20.13357 0.00030
2021-04-01 10:27:12,323 - 	 20.07931 0.00030
2021-04-01 10:27:58,135 - 	 20.29068 0.00030
2021-04-01 10:28:00,498 - 
 ---------------------- mean loss : 22.94125  ---------------------- 

2021-04-01 10:28:00,498 - Starting Validation
2021-04-01 10:28:18,609 - 
                     ------- validation -------            

2021-04-01 10:28:18,609 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:28:18,609 - 	 3.8406  	 0.2541  	 0.1117 	 0.5884
2021-04-01 10:28:18,609 - -------------------------------
Validation Epoch: 5 	Accuracy: 68.0000	Loss: 1418.311438
------------------
2021-04-01 10:28:18,609 - #### End epoch 5/1000, elapsed time: 167.0116196712479
2021-04-01 10:28:18,610 - 
 --------------------------- epoch 6 ------------------------- 

2021-04-01 10:28:18,610 - weights are [1, 1, 1, 3]
2021-04-01 10:28:21,609 - 	 20.23973 0.00030
2021-04-01 10:29:09,452 - 	 20.08008 0.00030
2021-04-01 10:29:57,089 - 	 20.19558 0.00030
2021-04-01 10:30:41,568 - 	 20.12368 0.00030
2021-04-01 10:30:45,161 - 
 ---------------------- mean loss : 21.83710  ---------------------- 

2021-04-01 10:30:45,161 - Starting Validation
2021-04-01 10:31:04,207 - 
                     ------- validation -------            

2021-04-01 10:31:04,208 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:31:04,208 - 	 3.8406  	 0.2189  	 0.1091 	 0.4634
2021-04-01 10:31:04,208 - -------------------------------
Validation Epoch: 6 	Accuracy: 68.0000	Loss: 1398.557152
------------------
2021-04-01 10:31:04,208 - #### End epoch 6/1000, elapsed time: 165.59846253879368
2021-04-01 10:31:04,208 - 
 --------------------------- epoch 7 ------------------------- 

2021-04-01 10:31:04,208 - weights are [1, 1, 1, 3]
2021-04-01 10:31:07,210 - 	 20.15336 0.00030
2021-04-01 10:31:55,439 - 	 20.03646 0.00030
2021-04-01 10:32:43,035 - 	 20.09855 0.00030
2021-04-01 10:33:29,901 - 	 20.17025 0.00030
2021-04-01 10:33:32,352 - 
 ---------------------- mean loss : 21.97223  ---------------------- 

2021-04-01 10:33:32,353 - Starting Validation
2021-04-01 10:33:50,946 - 
                     ------- validation -------            

2021-04-01 10:33:50,947 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:33:50,947 - 	 3.8406  	 0.2817  	 0.1082 	 0.7649
2021-04-01 10:33:50,947 - -------------------------------
Validation Epoch: 7 	Accuracy: 68.0000	Loss: 1443.705371
------------------
2021-04-01 10:33:50,947 - #### End epoch 7/1000, elapsed time: 166.73896843381226
2021-04-01 10:33:50,947 - 
 --------------------------- epoch 8 ------------------------- 

2021-04-01 10:33:50,947 - weights are [1, 1, 1, 3]
2021-04-01 10:33:57,728 - 	 20.09679 0.00030
2021-04-01 10:34:47,166 - 	 20.15131 0.00030
2021-04-01 10:35:32,138 - 	 20.09162 0.00030
2021-04-01 10:36:21,310 - 	 20.20213 0.00030
2021-04-01 10:36:23,638 - 
 ---------------------- mean loss : 21.89428  ---------------------- 

2021-04-01 10:36:23,638 - Starting Validation
2021-04-01 10:36:41,332 - 
                     ------- validation -------            

2021-04-01 10:36:41,332 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:36:41,332 - 	 3.8406  	 0.3308  	 0.1079 	 1.0288
2021-04-01 10:36:41,332 - -------------------------------
Validation Epoch: 8 	Accuracy: 68.0000	Loss: 1482.899638
------------------
2021-04-01 10:36:41,332 - #### End epoch 8/1000, elapsed time: 170.38543193787336
2021-04-01 10:36:41,332 - 
 --------------------------- epoch 9 ------------------------- 

2021-04-01 10:36:41,333 - weights are [1, 1, 1, 3]
2021-04-01 10:36:44,009 - 	 22.47722 0.00030
2021-04-01 10:37:31,943 - 	 20.14389 0.00030
2021-04-01 10:38:21,018 - 	 20.13024 0.00030
2021-04-01 10:39:11,246 - 	 20.05364 0.00030
2021-04-01 10:39:13,556 - 
 ---------------------- mean loss : 21.87468  ---------------------- 

2021-04-01 10:39:13,556 - Starting Validation
2021-04-01 10:39:31,979 - 
                     ------- validation -------            

2021-04-01 10:39:31,979 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:39:31,979 - 	 3.8406  	 0.2305  	 0.1057 	 0.5238
2021-04-01 10:39:31,979 - -------------------------------
Validation Epoch: 9 	Accuracy: 68.0000	Loss: 1407.104526
------------------
2021-04-01 10:39:31,979 - #### End epoch 9/1000, elapsed time: 170.6467714374885
2021-04-01 10:39:31,979 - 
 --------------------------- epoch 10 ------------------------- 

2021-04-01 10:39:31,979 - weights are [1, 1, 1, 3]
2021-04-01 10:39:36,143 - 	 20.30379 0.00030
2021-04-01 10:40:24,538 - 	 27.39477 0.00030
2021-04-01 10:41:04,139 - 	 20.14916 0.00030
2021-04-01 10:41:32,721 - 	 20.16420 0.00030
2021-04-01 10:41:34,200 - 
 ---------------------- mean loss : 21.61784  ---------------------- 

2021-04-01 10:41:34,200 - Starting Validation
2021-04-01 10:41:50,440 - 
                     ------- validation -------            

2021-04-01 10:41:50,440 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:41:50,440 - 	 3.8406  	 0.2450  	 0.1048 	 0.5806
2021-04-01 10:41:50,441 - -------------------------------
Validation Epoch: 10 	Accuracy: 68.0000	Loss: 1415.679571
------------------
2021-04-01 10:41:50,441 - #### End epoch 10/1000, elapsed time: 138.4613614520058
2021-04-01 10:41:50,441 - 
 --------------------------- epoch 11 ------------------------- 

2021-04-01 10:41:50,441 - weights are [1, 1, 1, 3]
2021-04-01 10:41:53,918 - 	 20.06733 0.00030
2021-04-01 10:42:28,493 - 	 20.09470 0.00030
2021-04-01 10:42:58,122 - 	 20.17902 0.00030
2021-04-01 10:43:26,929 - 	 20.07968 0.00030
2021-04-01 10:43:28,371 - 
 ---------------------- mean loss : 21.74929  ---------------------- 

2021-04-01 10:43:28,372 - Starting Validation
2021-04-01 10:43:44,051 - 
                     ------- validation -------            

2021-04-01 10:43:44,051 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:43:44,051 - 	 3.8406  	 0.3014  	 0.1049 	 0.8030
2021-04-01 10:43:44,051 - -------------------------------
Validation Epoch: 11 	Accuracy: 68.0000	Loss: 1449.780445
------------------
2021-04-01 10:43:44,051 - #### End epoch 11/1000, elapsed time: 113.61082244757563
2021-04-01 10:43:44,052 - 
 --------------------------- epoch 12 ------------------------- 

2021-04-01 10:43:44,052 - weights are [1, 1, 1, 3]
2021-04-01 10:43:46,913 - 	 20.03709 0.00030
2021-04-01 10:44:17,351 - 	 20.30782 0.00030
2021-04-01 10:44:46,696 - 	 21.01243 0.00030
2021-04-01 10:45:15,192 - 	 20.01715 0.00030
2021-04-01 10:45:16,673 - 
 ---------------------- mean loss : 22.20148  ---------------------- 

2021-04-01 10:45:16,673 - Starting Validation
2021-04-01 10:45:32,752 - 
                     ------- validation -------            

2021-04-01 10:45:32,752 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:45:32,752 - 	 3.8406  	 0.2331  	 0.1041 	 0.5610
2021-04-01 10:45:32,752 - -------------------------------
Validation Epoch: 12 	Accuracy: 68.0000	Loss: 1412.109662
------------------
2021-04-01 10:45:32,752 - #### End epoch 12/1000, elapsed time: 108.70076101645827
2021-04-01 10:45:32,752 - 
 --------------------------- epoch 13 ------------------------- 

2021-04-01 10:45:32,752 - weights are [1, 1, 1, 3]
2021-04-01 10:45:35,407 - 	 20.08091 0.00030
2021-04-01 10:46:05,984 - 	 20.14837 0.00030
2021-04-01 10:46:35,804 - 	 20.05090 0.00030
2021-04-01 10:47:04,590 - 	 20.27563 0.00030
2021-04-01 10:47:06,080 - 
 ---------------------- mean loss : 21.73545  ---------------------- 

2021-04-01 10:47:06,080 - Starting Validation
2021-04-01 10:47:22,021 - 
                     ------- validation -------            

2021-04-01 10:47:22,021 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:47:22,021 - 	 3.8406  	 0.2226  	 0.1056 	 0.5005
2021-04-01 10:47:22,021 - -------------------------------
Validation Epoch: 13 	Accuracy: 68.0000	Loss: 1403.373927
------------------
2021-04-01 10:47:22,021 - #### End epoch 13/1000, elapsed time: 109.26877022348344
2021-04-01 10:47:22,021 - 
 --------------------------- epoch 14 ------------------------- 

2021-04-01 10:47:22,021 - weights are [1, 1, 1, 3]
2021-04-01 10:47:25,846 - 	 20.05227 0.00030
2021-04-01 10:47:57,102 - 	 20.05967 0.00030
2021-04-01 10:48:27,153 - 	 20.05902 0.00030
2021-04-01 10:48:56,209 - 	 20.16291 0.00030
2021-04-01 10:48:57,655 - 
 ---------------------- mean loss : 22.70743  ---------------------- 

2021-04-01 10:48:57,655 - Starting Validation
2021-04-01 10:49:13,422 - 
                     ------- validation -------            

2021-04-01 10:49:13,422 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:49:13,422 - 	 3.8406  	 0.2566  	 0.1037 	 0.6558
2021-04-01 10:49:13,422 - -------------------------------
Validation Epoch: 14 	Accuracy: 68.0000	Loss: 1426.546218
------------------
2021-04-01 10:49:13,422 - #### End epoch 14/1000, elapsed time: 111.4012033874169
2021-04-01 10:49:13,423 - 
 --------------------------- epoch 15 ------------------------- 

2021-04-01 10:49:13,423 - weights are [1, 1, 1, 3]
2021-04-01 10:49:16,107 - 	 20.04909 0.00030
2021-04-01 10:49:46,986 - 	 20.14878 0.00030
2021-04-01 10:50:16,748 - 	 20.36230 0.00030
2021-04-01 10:50:45,439 - 	 20.06769 0.00030
2021-04-01 10:50:46,929 - 
 ---------------------- mean loss : 22.08323  ---------------------- 

2021-04-01 10:50:46,929 - Starting Validation
2021-04-01 10:51:07,153 - 
                     ------- validation -------            

2021-04-01 10:51:07,153 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:51:07,153 - 	 3.8406  	 0.2190  	 0.1028 	 0.5031
2021-04-01 10:51:07,153 - -------------------------------
Validation Epoch: 15 	Accuracy: 68.0000	Loss: 1403.094662
------------------
2021-04-01 10:51:07,153 - #### End epoch 15/1000, elapsed time: 113.73081033304334
2021-04-01 10:51:07,153 - 
 --------------------------- epoch 16 ------------------------- 

2021-04-01 10:51:07,153 - weights are [1, 1, 1, 3]
2021-04-01 10:51:11,090 - 	 21.43053 0.00030
2021-04-01 10:52:00,595 - 	 20.18396 0.00030
2021-04-01 10:52:47,768 - 	 50.71613 0.00030
2021-04-01 10:53:33,570 - 	 20.11419 0.00030
2021-04-01 10:53:35,522 - 
 ---------------------- mean loss : 22.34752  ---------------------- 

2021-04-01 10:53:35,523 - Starting Validation
