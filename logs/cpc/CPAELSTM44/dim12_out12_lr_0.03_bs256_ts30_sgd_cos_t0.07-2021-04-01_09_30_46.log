2021-04-01 09:30:46,960 - ===> use benchmark strategy to split train, validation and eval dataset
2021-04-01 09:30:48,282 - ### Model summary below###
 CPAELSTM44(
  (lstm1): LSTM(76, 12, batch_first=True)
  (lstm2): LSTM(12, 12, batch_first=True)
  (lstm3): LSTM(12, 12, batch_first=True)
  (dropout): Dropout(p=0.3, inplace=False)
  (softmax): Softmax(dim=0)
  (lsoftmax): LogSoftmax()
  (fcs): Sequential(
    (0): Linear(in_features=12, out_features=12, bias=True)
    (1): ReLU(inplace=True)
    (2): Linear(in_features=12, out_features=12, bias=True)
  )
  (lstm4): LSTM(12, 76, batch_first=True)
)

2021-04-01 09:30:48,282 - ===> Model total parameter: 34488

2021-04-01 09:30:48,282 - {'data_split': 'benchmark', 'batch_size': 256, 'mode': 0, 'dim': 12, 'bn': False, 'dropout': 0.3, 'task': 'ihm', 'learning_rate': 0.03, 'epochs': 1000, 'seed': 1, 'log_interval': 5, 'num_workers': 30, 'gru_out': 12, 'sim': 'cosine', 'temperature': 0.07, 'optimizer': 'optim.SGD(filter(lambda p: p.requires_grad,model.parameters()), lr=0.03, momentum=0.9, weight_decay=1e-4)', 'adjust_lr': True, 'setting_name': 'dim12_out12_lr_0.03_bs256_ts30_sgd_cos_t0.07', 'run_name': 'dim12_out12_lr_0.03_bs256_ts30_sgd_cos_t0.07-2021-04-01_09_30_46', 'model_type': 'CPAELSTM44', 'resume': False, 'model_best': 'dim12_out12_lr_1_bs256_ts50_sgd_cos_t0.07-2021-04-01_09_12_13-model_best.pth', 'save_every': 100, 'lambda': [1, 1, 1, 3], 'time_step': 30, 'sym': False, 'top_path': '/home/shuying/CPAE/', 'scr_data_path': '/home/shuying/cpcSurvival/data', 'logging_dir': '/home/shuying/CPAE/logs/cpc/CPAELSTM44', 'ini_file': '/home/shuying/CPAE/logs/cpc/CPAELSTM44/dim12_out12_lr_0.03_bs256_ts30_sgd_cos_t0.07.ini', 'updated_lr': 0.03}
2021-04-01 09:30:48,282 - 
 --------------------------- epoch 1 ------------------------- 

2021-04-01 09:30:48,282 - weights are [1, 1, 1, 3]
2021-04-01 09:30:57,321 - 	 28.70902 0.03000
2021-04-01 09:32:17,169 - 
 ---------------------- mean loss : 29.76098  ---------------------- 

2021-04-01 09:32:17,170 - Starting Validation
2021-04-01 09:32:31,878 - 
                     ------- validation -------            

2021-04-01 09:32:31,878 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:32:31,878 - 	 5.5041  	 0.2859  	 0.1032 	 0.7673
2021-04-01 09:32:31,878 - -------------------------------
Validation Epoch: 1 	Accuracy: 13.0000	Loss: 384.113184
------------------
2021-04-01 09:32:31,880 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44/dim12_out12_lr_0.03_bs256_ts30_sgd_cos_t0.07-2021-04-01_09_30_46-model_best.pth

2021-04-01 09:32:31,885 - Best model updated in 'dim12_out12_lr_0.03_bs256_ts30_sgd_cos_t0.07.ini'! !!!!!!!!!
2021-04-01 09:32:31,885 - #### End epoch 1/1000, elapsed time: 103.60317115020007
2021-04-01 09:32:31,886 - 
 --------------------------- epoch 2 ------------------------- 

2021-04-01 09:32:31,886 - weights are [1, 1, 1, 3]
2021-04-01 09:32:51,086 - 	 28.51740 0.03000
2021-04-01 09:34:37,061 - 
 ---------------------- mean loss : 30.62931  ---------------------- 

2021-04-01 09:34:37,063 - Starting Validation
2021-04-01 09:34:53,112 - 
                     ------- validation -------            

2021-04-01 09:34:53,112 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:34:53,112 - 	 5.5041  	 0.2630  	 0.1019 	 0.7000
2021-04-01 09:34:53,112 - -------------------------------
Validation Epoch: 2 	Accuracy: 13.0000	Loss: 382.030804
------------------
2021-04-01 09:34:53,112 - #### End epoch 2/1000, elapsed time: 141.2268380438909
2021-04-01 09:34:53,113 - 
 --------------------------- epoch 3 ------------------------- 

2021-04-01 09:34:53,113 - weights are [1, 1, 1, 3]
2021-04-01 09:35:05,658 - 	 28.51752 0.03000
2021-04-01 09:37:01,498 - 
 ---------------------- mean loss : 29.86799  ---------------------- 

2021-04-01 09:37:01,500 - Starting Validation
2021-04-01 09:37:17,508 - 
                     ------- validation -------            

2021-04-01 09:37:17,508 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:37:17,508 - 	 5.5041  	 0.2659  	 0.1027 	 0.7373
2021-04-01 09:37:17,508 - -------------------------------
Validation Epoch: 3 	Accuracy: 13.0000	Loss: 383.059584
------------------
2021-04-01 09:37:17,508 - #### End epoch 3/1000, elapsed time: 144.39580946601927
2021-04-01 09:37:17,509 - 
 --------------------------- epoch 4 ------------------------- 

2021-04-01 09:37:17,509 - weights are [1, 1, 1, 3]
2021-04-01 09:37:29,394 - 	 28.44088 0.03000
2021-04-01 09:39:22,961 - 
 ---------------------- mean loss : 30.33740  ---------------------- 

2021-04-01 09:39:22,961 - Starting Validation
2021-04-01 09:39:38,188 - 
                     ------- validation -------            

2021-04-01 09:39:38,188 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:39:38,188 - 	 5.5041  	 0.3015  	 0.1063 	 0.8664
2021-04-01 09:39:38,188 - -------------------------------
Validation Epoch: 4 	Accuracy: 13.0000	Loss: 386.973249
------------------
2021-04-01 09:39:38,188 - #### End epoch 4/1000, elapsed time: 140.67976313177496
2021-04-01 09:39:38,188 - 
 --------------------------- epoch 5 ------------------------- 

2021-04-01 09:39:38,188 - weights are [1, 1, 1, 3]
2021-04-01 09:39:51,158 - 	 28.48259 0.03000
2021-04-01 09:41:57,528 - 
 ---------------------- mean loss : 30.03396  ---------------------- 

2021-04-01 09:41:57,531 - Starting Validation
2021-04-01 09:42:12,869 - 
                     ------- validation -------            

2021-04-01 09:42:12,869 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:42:12,869 - 	 5.5041  	 0.2215  	 0.1026 	 0.5360
2021-04-01 09:42:12,869 - -------------------------------
Validation Epoch: 5 	Accuracy: 13.0000	Loss: 377.246437
------------------
2021-04-01 09:42:12,869 - #### End epoch 5/1000, elapsed time: 154.6809028238058
2021-04-01 09:42:12,869 - 
 --------------------------- epoch 6 ------------------------- 

2021-04-01 09:42:12,869 - weights are [1, 1, 1, 3]
2021-04-01 09:42:30,200 - 	 85.48328 0.03000
2021-04-01 09:44:19,891 - 
 ---------------------- mean loss : 30.06032  ---------------------- 

2021-04-01 09:44:19,891 - Starting Validation
2021-04-01 09:44:34,995 - 
                     ------- validation -------            

2021-04-01 09:44:34,995 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:44:34,995 - 	 5.5041  	 0.2823  	 0.1034 	 0.8241
2021-04-01 09:44:34,996 - -------------------------------
Validation Epoch: 6 	Accuracy: 13.0000	Loss: 385.548351
------------------
2021-04-01 09:44:34,996 - #### End epoch 6/1000, elapsed time: 142.12641175091267
2021-04-01 09:44:34,996 - 
 --------------------------- epoch 7 ------------------------- 

2021-04-01 09:44:34,996 - weights are [1, 1, 1, 3]
2021-04-01 09:44:51,818 - 	 55.72445 0.03000
2021-04-01 09:46:42,407 - 
 ---------------------- mean loss : 29.83683  ---------------------- 

2021-04-01 09:46:42,409 - Starting Validation
2021-04-01 09:46:57,603 - 
                     ------- validation -------            

2021-04-01 09:46:57,603 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:46:57,603 - 	 5.5041  	 0.1899  	 0.1030 	 0.3966
2021-04-01 09:46:57,603 - -------------------------------
Validation Epoch: 7 	Accuracy: 13.0000	Loss: 373.220106
------------------
2021-04-01 09:46:57,604 - #### End epoch 7/1000, elapsed time: 142.60794330015779
2021-04-01 09:46:57,604 - 
 --------------------------- epoch 8 ------------------------- 

2021-04-01 09:46:57,604 - weights are [1, 1, 1, 3]
2021-04-01 09:47:08,241 - 	 28.39716 0.03000
2021-04-01 09:48:58,615 - 
 ---------------------- mean loss : 30.74086  ---------------------- 

2021-04-01 09:48:58,618 - Starting Validation
2021-04-01 09:49:13,912 - 
                     ------- validation -------            

2021-04-01 09:49:13,913 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:49:13,913 - 	 5.5041  	 0.2553  	 0.1031 	 0.7049
2021-04-01 09:49:13,913 - -------------------------------
Validation Epoch: 8 	Accuracy: 13.0000	Loss: 382.092251
------------------
2021-04-01 09:49:13,913 - #### End epoch 8/1000, elapsed time: 136.30927533004433
2021-04-01 09:49:13,913 - 
 --------------------------- epoch 9 ------------------------- 

2021-04-01 09:49:13,913 - weights are [1, 1, 1, 3]
2021-04-01 09:49:27,907 - 	 28.84142 0.03000
