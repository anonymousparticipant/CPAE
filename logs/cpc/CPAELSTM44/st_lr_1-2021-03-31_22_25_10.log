2021-03-31 22:25:10,299 - ===> use benchmark strategy to split train, validation and eval dataset
2021-03-31 22:25:13,622 - ### Model summary below###
 CPAELSTM44(
  (lstm1): LSTM(76, 256, batch_first=True)
  (lstm2): LSTM(256, 256, batch_first=True)
  (lstm3): LSTM(256, 256, batch_first=True)
  (dropout): Dropout(p=0.3, inplace=False)
  (softmax): Softmax(dim=0)
  (lsoftmax): LogSoftmax()
  (fcs): Sequential(
    (0): Linear(in_features=256, out_features=256, bias=True)
    (1): ReLU(inplace=True)
    (2): Linear(in_features=256, out_features=256, bias=True)
  )
  (lstm4): LSTM(256, 76, batch_first=True)
)

2021-03-31 22:25:13,622 - ===> Model total parameter: 1627808

2021-03-31 22:25:13,622 - {'data_split': 'benchmark', 'batch_size': 48, 'n_points': 192, 'n_features': 76, 'time_step': 30, 'mode': 0, 'points_per_hour': 4, 'frame_size': 16, 'n_frames': 12, 'dim': 256, 'bn': False, 'dropout': 0.3, 'task': 'ihm', 'learning_rate': 1, 'epochs': 1000, 'seed': 1, 'log_interval': 30, 'num_workers': 30, 'gru_out': 256, 'optimizer': 'optim.Adam(filter(lambda p: p.requires_grad, model.parameters()), lr=1, betas=(0.9, 0.98), eps=1e-09,weight_decay=1e-4)', 'model_params': None, 'setting_name': 'st_lr_1', 'run_name': 'st_lr_1-2021-03-31_22_25_10', 'model_type': 'CPAELSTM44', 'resume': False, 'model_best': 'st.pth', 'save_every': 100, 'lambda': [1, 1, 1, 3], 'top_path': '/home/shuying/CPAE/', 'scr_data_path': '/home/shuying/cpcSurvival/data', 'logging_dir': '/home/shuying/CPAE/logs/cpc/CPAELSTM44', 'ini_file': '/home/shuying/CPAE/logs/cpc/CPAELSTM44/st_lr_1.ini'}
2021-03-31 22:25:13,622 - 
 --------------------------- epoch 1 ------------------------- 

2021-03-31 22:25:13,622 - weights are [1, 1, 1, 3]
2021-03-31 22:25:24,291 - 	 20.21744 1.00000
2021-03-31 22:27:16,989 - 	 5074443264.00000 1.00000
2021-03-31 22:29:09,846 - 	 2093387392.00000 1.00000
2021-03-31 22:31:03,441 - 	 1227187968.00000 1.00000
2021-03-31 22:31:08,733 - 
 ---------------------- mean loss : 4378111274043.88330  ---------------------- 

2021-03-31 22:31:08,734 - Starting Validation
2021-03-31 22:31:39,965 - 
                     ------- validation -------            

2021-03-31 22:31:39,965 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-03-31 22:31:39,965 - 	 674581819.7647  	 0.2513  	 0.1603 	 0.5564
2021-03-31 22:31:39,965 - -------------------------------
Validation Epoch: 1 	Accuracy: 68.0000	Loss: 229357818240.000000
------------------
2021-03-31 22:31:40,079 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44/st_lr_1-2021-03-31_22_25_10-model_best.pth

2021-03-31 22:31:40,080 - Best model updated in 'st_lr_1.ini'! !!!!!!!!!
2021-03-31 22:31:40,122 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44/st_lr_1-2021-03-31_22_25_10-model_best.pth

2021-03-31 22:31:40,122 - model got improved for this run, but did not surpass previous though, please take changes of hyper parameters into consideration
2021-03-31 22:31:40,122 - #### End epoch 1/1000, elapsed time: 386.5003310749307
2021-03-31 22:31:40,123 - 
 --------------------------- epoch 2 ------------------------- 

2021-03-31 22:31:40,123 - weights are [1, 1, 1, 3]
2021-03-31 22:31:50,423 - 	 4330393088.00000 1.00000
2021-03-31 22:33:44,791 - 	 520927232.00000 1.00000
2021-03-31 22:35:38,384 - 	 1442300032.00000 1.00000
2021-03-31 22:37:31,871 - 	 597232640.00000 1.00000
2021-03-31 22:37:37,532 - 
 ---------------------- mean loss : 1129555783.39869  ---------------------- 

2021-03-31 22:37:37,532 - Starting Validation
2021-03-31 22:38:08,211 - 
                     ------- validation -------            

2021-03-31 22:38:08,211 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-03-31 22:38:08,211 - 	 56382895.2647  	 0.3469  	 0.1351 	 0.8201
2021-03-31 22:38:08,211 - -------------------------------
Validation Epoch: 2 	Accuracy: 68.0000	Loss: 19170184368.000000
------------------
2021-03-31 22:38:08,211 - #### End epoch 2/1000, elapsed time: 388.0890457360074
2021-03-31 22:38:08,212 - 
 --------------------------- epoch 3 ------------------------- 

2021-03-31 22:38:08,212 - weights are [1, 1, 1, 3]
2021-03-31 22:38:17,591 - 	 313831392.00000 1.00000
2021-03-31 22:40:12,255 - 	 121094368.00000 1.00000
2021-03-31 22:42:05,707 - 	 167558432.00000 1.00000
2021-03-31 22:43:59,463 - 	 20688806.00000 1.00000
2021-03-31 22:44:05,083 - 
 ---------------------- mean loss : 284875840.75163  ---------------------- 

2021-03-31 22:44:05,083 - Starting Validation
2021-03-31 22:44:35,571 - 
                     ------- validation -------            

2021-03-31 22:44:35,571 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-03-31 22:44:35,572 - 	 5130620.3566  	 0.3010  	 0.1344 	 0.7284
2021-03-31 22:44:35,572 - -------------------------------
Validation Epoch: 3 	Accuracy: 68.0000	Loss: 1744410994.000000
------------------
2021-03-31 22:44:35,572 - #### End epoch 3/1000, elapsed time: 387.3601547004655
2021-03-31 22:44:35,572 - 
 --------------------------- epoch 4 ------------------------- 

2021-03-31 22:44:35,572 - weights are [1, 1, 1, 3]
2021-03-31 22:44:42,760 - 	 28347942.00000 1.00000
2021-03-31 22:46:38,983 - 	 190695280.00000 1.00000
2021-03-31 22:48:32,987 - 	 79164504.00000 1.00000
2021-03-31 22:50:26,554 - 	 20.77018 1.00000
2021-03-31 22:50:32,093 - 
 ---------------------- mean loss : 447324225414.45801  ---------------------- 

2021-03-31 22:50:32,093 - Starting Validation
2021-03-31 22:51:02,496 - 
                     ------- validation -------            

2021-03-31 22:51:02,496 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-03-31 22:51:02,496 - 	 3.8403  	 0.2828  	 0.1626 	 0.5841
2021-03-31 22:51:02,497 - -------------------------------
Validation Epoch: 4 	Accuracy: 68.0000	Loss: 1426.470892
------------------
2021-03-31 22:51:02,497 - #### End epoch 4/1000, elapsed time: 386.9248682372272
2021-03-31 22:51:02,497 - 
 --------------------------- epoch 5 ------------------------- 

2021-03-31 22:51:02,497 - weights are [1, 1, 1, 3]
2021-03-31 22:51:10,034 - 	 20.51769 1.00000
2021-03-31 22:53:05,945 - 	 204.76457 1.00000
2021-03-31 22:54:59,784 - 	 20.88963 1.00000
2021-03-31 22:56:53,376 - 	 20.29404 1.00000
2021-03-31 22:56:58,571 - 
 ---------------------- mean loss : 9394871.09957  ---------------------- 

2021-03-31 22:56:58,571 - Starting Validation
2021-03-31 22:57:26,771 - 
                     ------- validation -------            

2021-03-31 22:57:26,771 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-03-31 22:57:26,771 - 	 3.8405  	 0.3597  	 0.1933 	 0.8232
2021-03-31 22:57:26,771 - -------------------------------
Validation Epoch: 5 	Accuracy: 68.0000	Loss: 1468.482444
------------------
2021-03-31 22:57:26,771 - #### End epoch 5/1000, elapsed time: 384.27482446469367
2021-03-31 22:57:26,772 - 
 --------------------------- epoch 6 ------------------------- 

2021-03-31 22:57:26,772 - weights are [1, 1, 1, 3]
2021-03-31 22:57:34,286 - 	 20.57822 1.00000
2021-03-31 22:59:29,432 - 	 20.54953 1.00000
2021-03-31 23:01:23,389 - 	 20.59353 1.00000
2021-03-31 23:03:17,045 - 	 20.42279 1.00000
2021-03-31 23:03:22,381 - 
 ---------------------- mean loss : 21.58995  ---------------------- 

2021-03-31 23:03:22,381 - Starting Validation
2021-03-31 23:03:52,398 - 
                     ------- validation -------            

2021-03-31 23:03:52,399 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-03-31 23:03:52,400 - 	 3.8406  	 0.2518  	 0.2186 	 0.4738
2021-03-31 23:03:52,400 - -------------------------------
Validation Epoch: 6 	Accuracy: 68.0000	Loss: 1417.096601
------------------
2021-03-31 23:03:52,400 - #### End epoch 6/1000, elapsed time: 385.6282550934702
2021-03-31 23:03:52,400 - 
 --------------------------- epoch 7 ------------------------- 

2021-03-31 23:03:52,400 - weights are [1, 1, 1, 3]
2021-03-31 23:03:59,705 - 	 20.49184 1.00000
2021-03-31 23:05:55,596 - 	 21.02620 1.00000
2021-03-31 23:07:49,198 - 	 20.26754 1.00000
2021-03-31 23:09:43,078 - 	 58769732009984.00000 1.00000
2021-03-31 23:09:48,430 - 
 ---------------------- mean loss : 298139421262657.93750  ---------------------- 

2021-03-31 23:09:48,430 - Starting Validation
2021-03-31 23:10:18,612 - 
                     ------- validation -------            

2021-03-31 23:10:18,612 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-03-31 23:10:18,612 - 	 3832777185400.4707  	 0.3350  	 0.1664 	 1.1120
2021-03-31 23:10:18,612 - -------------------------------
Validation Epoch: 7 	Accuracy: 68.0000	Loss: 1303144240775168.000000
------------------
2021-03-31 23:10:18,612 - #### End epoch 7/1000, elapsed time: 386.21237677987665
2021-03-31 23:10:18,612 - 
 --------------------------- epoch 8 ------------------------- 

2021-03-31 23:10:18,612 - weights are [1, 1, 1, 3]
2021-03-31 23:10:24,765 - 	 14676822851584.00000 1.00000
