2021-04-01 09:57:55,275 - ===> use benchmark strategy to split train, validation and eval dataset
2021-04-01 09:57:56,575 - ### Model summary below###
 CPAELSTM44_AT(
  (lstm1): LSTM(76, 24, batch_first=True)
  (lstm2): LSTM(24, 24, batch_first=True)
  (lstm3): LSTM(24, 24, batch_first=True)
  (dropout): Dropout(p=0.3, inplace=False)
  (softmax): Softmax(dim=0)
  (lsoftmax): LogSoftmax()
  (fcs): Sequential(
    (0): Linear(in_features=24, out_features=24, bias=True)
    (1): ReLU(inplace=True)
    (2): Linear(in_features=24, out_features=24, bias=True)
  )
  (lstm4): LSTM(24, 76, batch_first=True)
  (att1): Linear(in_features=24, out_features=24, bias=True)
  (att2): Linear(in_features=24, out_features=24, bias=True)
  (W_pred): Linear(in_features=24, out_features=24, bias=True)
)

2021-04-01 09:57:56,575 - ===> Model total parameter: 53400

2021-04-01 09:57:56,575 - {'data_split': 'benchmark', 'batch_size': 256, 'mode': 0, 'dim': 24, 'bn': False, 'dropout': 0.3, 'task': 'ihm', 'learning_rate': 0.03, 'epochs': 1000, 'seed': 1, 'log_interval': 2, 'num_workers': 30, 'gru_out': 24, 'sim': 'cosine', 'temperature': 0.07, 'optimizer': 'optim.SGD(filter(lambda p: p.requires_grad,model.parameters()), lr=0.03, momentum=0.9, weight_decay=1e-4)', 'adjust_lr': True, 'setting_name': 'dim24_out24_lr_0.03_bs256_future_sgd_cos_t0.07', 'run_name': 'dim24_out24_lr_0.03_bs256_future_sgd_cos_t0.07-2021-04-01_09_57_55', 'model_type': 'CPAELSTM44_AT', 'resume': False, 'model_best': 'dim12_out12_lr_0.03_bs256_future_sgd_cos_t0.07-2021-04-01_09_50_09-model_best.pth', 'save_every': 100, 'lambda': [1, 1, 1, 3], 'time_step': 30, 'sym': False, 'top_path': '/home/shuying/CPAE/', 'scr_data_path': '/home/shuying/cpcSurvival/data', 'logging_dir': '/home/shuying/CPAE/logs/cpc/CPAELSTM44_AT', 'ini_file': '/home/shuying/CPAE/logs/cpc/CPAELSTM44_AT/dim24_out24_lr_0.03_bs256_future_sgd_cos_t0.07.ini', 'updated_lr': 0.03, 'pred_mode': 'future', 't_range': (0.5, 0.7)}
2021-04-01 09:57:56,575 - 
 --------------------------- epoch 1 ------------------------- 

2021-04-01 09:57:56,575 - weights are [1, 1, 1, 3]
2021-04-01 09:58:08,553 - 	 28.60678 0.03000
2021-04-01 09:59:23,647 - 
 ---------------------- mean loss : 29.60541  ---------------------- 

2021-04-01 09:59:23,649 - Starting Validation
2021-04-01 09:59:39,377 - 
                     ------- validation -------            

2021-04-01 09:59:39,378 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:59:39,378 - 	 5.5041  	 0.2176  	 0.0991 	 0.4786
2021-04-01 09:59:39,378 - -------------------------------
Validation Epoch: 1 	Accuracy: 13.0000	Loss: 375.613674
------------------
2021-04-01 09:59:39,381 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44_AT/dim24_out24_lr_0.03_bs256_future_sgd_cos_t0.07-2021-04-01_09_57_55-model_best.pth

2021-04-01 09:59:39,382 - Best model updated in 'dim24_out24_lr_0.03_bs256_future_sgd_cos_t0.07.ini'! !!!!!!!!!
2021-04-01 09:59:39,382 - #### End epoch 1/1000, elapsed time: 102.80745108239353
2021-04-01 09:59:39,383 - 
 --------------------------- epoch 2 ------------------------- 

2021-04-01 09:59:39,383 - weights are [1, 1, 1, 3]
2021-04-01 09:59:53,885 - 	 28.49128 0.03000
2021-04-01 10:01:27,218 - 
 ---------------------- mean loss : 29.53999  ---------------------- 

2021-04-01 10:01:27,219 - Starting Validation
2021-04-01 10:01:43,374 - 
                     ------- validation -------            

2021-04-01 10:01:43,374 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:01:43,374 - 	 5.5041  	 0.2117  	 0.0983 	 0.4738
2021-04-01 10:01:43,374 - -------------------------------
Validation Epoch: 2 	Accuracy: 14.0000	Loss: 375.392002
------------------
2021-04-01 10:01:43,378 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44_AT/dim24_out24_lr_0.03_bs256_future_sgd_cos_t0.07-2021-04-01_09_57_55-model_best.pth

2021-04-01 10:01:43,378 - Best model updated in 'dim24_out24_lr_0.03_bs256_future_sgd_cos_t0.07.ini'! !!!!!!!!!
2021-04-01 10:01:43,378 - #### End epoch 2/1000, elapsed time: 123.99597885739058
2021-04-01 10:01:43,379 - 
 --------------------------- epoch 3 ------------------------- 

2021-04-01 10:01:43,379 - weights are [1, 1, 1, 3]
2021-04-01 10:01:55,007 - 	 28.43263 0.03000
2021-04-01 10:03:29,599 - 
 ---------------------- mean loss : 29.53254  ---------------------- 

2021-04-01 10:03:29,601 - Starting Validation
2021-04-01 10:03:45,172 - 
                     ------- validation -------            

2021-04-01 10:03:45,172 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:03:45,172 - 	 5.5041  	 0.2094  	 0.0983 	 0.4719
2021-04-01 10:03:45,172 - -------------------------------
Validation Epoch: 3 	Accuracy: 12.0000	Loss: 375.311367
------------------
2021-04-01 10:03:45,174 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44_AT/dim24_out24_lr_0.03_bs256_future_sgd_cos_t0.07-2021-04-01_09_57_55-model_best.pth

2021-04-01 10:03:45,174 - model got improved for this run, but did not surpass previous though, please take changes of hyper parameters into consideration
2021-04-01 10:03:45,174 - #### End epoch 3/1000, elapsed time: 121.79590308573097
2021-04-01 10:03:45,174 - 
 --------------------------- epoch 4 ------------------------- 

2021-04-01 10:03:45,174 - weights are [1, 1, 1, 3]
2021-04-01 10:04:00,282 - 	 28.66199 0.03000
2021-04-01 10:05:35,065 - 
 ---------------------- mean loss : 29.52618  ---------------------- 

2021-04-01 10:05:35,066 - Starting Validation
2021-04-01 10:05:50,707 - 
                     ------- validation -------            

2021-04-01 10:05:50,707 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:05:50,707 - 	 5.5041  	 0.2079  	 0.0982 	 0.4705
2021-04-01 10:05:50,707 - -------------------------------
Validation Epoch: 4 	Accuracy: 14.0000	Loss: 375.255583
------------------
2021-04-01 10:05:50,707 - #### End epoch 4/1000, elapsed time: 125.53306831140071
2021-04-01 10:05:50,708 - 
 --------------------------- epoch 5 ------------------------- 

2021-04-01 10:05:50,708 - weights are [1, 1, 1, 3]
2021-04-01 10:06:03,953 - 	 28.45164 0.03000
2021-04-01 10:07:17,660 - 
 ---------------------- mean loss : 29.59666  ---------------------- 

2021-04-01 10:07:17,660 - Starting Validation
2021-04-01 10:07:31,857 - 
                     ------- validation -------            

2021-04-01 10:07:31,857 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:07:31,857 - 	 5.5041  	 0.2067  	 0.0982 	 0.4685
2021-04-01 10:07:31,857 - -------------------------------
Validation Epoch: 5 	Accuracy: 13.0000	Loss: 375.184820
------------------
2021-04-01 10:07:31,861 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44_AT/dim24_out24_lr_0.03_bs256_future_sgd_cos_t0.07-2021-04-01_09_57_55-model_best.pth

2021-04-01 10:07:31,861 - model got improved for this run, but did not surpass previous though, please take changes of hyper parameters into consideration
2021-04-01 10:07:31,861 - #### End epoch 5/1000, elapsed time: 101.15325467474759
2021-04-01 10:07:31,861 - 
 --------------------------- epoch 6 ------------------------- 

2021-04-01 10:07:31,861 - weights are [1, 1, 1, 3]
2021-04-01 10:07:40,113 - 	 28.51677 0.03000
2021-04-01 10:08:45,134 - 
 ---------------------- mean loss : 29.51265  ---------------------- 

2021-04-01 10:08:45,138 - Starting Validation
2021-04-01 10:08:59,673 - 
                     ------- validation -------            

2021-04-01 10:08:59,673 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:08:59,673 - 	 5.5041  	 0.2045  	 0.0982 	 0.4611
2021-04-01 10:08:59,674 - -------------------------------
Validation Epoch: 6 	Accuracy: 11.0000	Loss: 374.963398
------------------
2021-04-01 10:08:59,674 - #### End epoch 6/1000, elapsed time: 87.81293163634837
2021-04-01 10:08:59,674 - 
 --------------------------- epoch 7 ------------------------- 

2021-04-01 10:08:59,674 - weights are [1, 1, 1, 3]
2021-04-01 10:09:10,119 - 	 28.50063 0.03000
2021-04-01 10:10:16,259 - 
 ---------------------- mean loss : 29.46925  ---------------------- 

2021-04-01 10:10:16,263 - Starting Validation
2021-04-01 10:10:33,817 - 
                     ------- validation -------            

2021-04-01 10:10:33,818 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:10:33,818 - 	 5.5041  	 0.1973  	 0.0985 	 0.4297
2021-04-01 10:10:33,818 - -------------------------------
Validation Epoch: 7 	Accuracy: 14.0000	Loss: 374.060436
------------------
2021-04-01 10:10:33,818 - #### End epoch 7/1000, elapsed time: 94.14432767406106
2021-04-01 10:10:33,818 - 
 --------------------------- epoch 8 ------------------------- 

2021-04-01 10:10:33,818 - weights are [1, 1, 1, 3]
2021-04-01 10:10:45,127 - 	 28.74194 0.03000
