2021-04-01 10:16:10,046 - ===> use benchmark strategy to split train, validation and eval dataset
2021-04-01 10:16:11,406 - ### Model summary below###
 CPAELSTM44_AT(
  (lstm1): LSTM(76, 12, batch_first=True)
  (lstm2): LSTM(12, 12, batch_first=True)
  (lstm3): LSTM(12, 12, batch_first=True)
  (dropout): Dropout(p=0.3, inplace=False)
  (softmax): Softmax(dim=0)
  (lsoftmax): LogSoftmax()
  (fcs): Sequential(
    (0): Linear(in_features=12, out_features=12, bias=True)
    (1): ReLU(inplace=True)
    (2): Linear(in_features=12, out_features=12, bias=True)
  )
  (lstm4): LSTM(12, 76, batch_first=True)
  (att1): Linear(in_features=12, out_features=12, bias=True)
  (att2): Linear(in_features=12, out_features=12, bias=True)
  (W_pred): Linear(in_features=12, out_features=12, bias=True)
)

2021-04-01 10:16:11,406 - ===> Model total parameter: 34956

2021-04-01 10:16:11,406 - {'data_split': 'benchmark', 'batch_size': 256, 'mode': 0, 'dim': 12, 'bn': False, 'dropout': 0.3, 'task': 'ihm', 'learning_rate': 0.0003, 'epochs': 1000, 'seed': 1, 'log_interval': 5, 'num_workers': 30, 'gru_out': 12, 'sim': 'cosine', 'temperature': 0.07, 'optimizer': 'optim.SGD(filter(lambda p: p.requires_grad,model.parameters()), lr=0.0003, momentum=0.9, weight_decay=1e-4)', 'adjust_lr': True, 'setting_name': 'dim12_out12_lr_0.0003_bs256_future_sgd_cos_t0.07', 'run_name': 'dim12_out12_lr_0.0003_bs256_future_sgd_cos_t0.07-2021-04-01_10_16_10', 'model_type': 'CPAELSTM44_AT', 'resume': False, 'model_best': 'dim12_out12_lr_0.03_bs256_future_sgd_cos_t0.07-2021-04-01_09_50_09-model_best.pth', 'save_every': 100, 'lambda': [1, 1, 1, 3], 'time_step': 30, 'sym': False, 'top_path': '/home/shuying/CPAE/', 'scr_data_path': '/home/shuying/cpcSurvival/data', 'logging_dir': '/home/shuying/CPAE/logs/cpc/CPAELSTM44_AT', 'ini_file': '/home/shuying/CPAE/logs/cpc/CPAELSTM44_AT/dim12_out12_lr_0.0003_bs256_future_sgd_cos_t0.07.ini', 'updated_lr': 0.03, 'pred_mode': 'future', 't_range': (0.5, 0.7)}
2021-04-01 10:16:11,406 - 
 --------------------------- epoch 1 ------------------------- 

2021-04-01 10:16:11,406 - weights are [1, 1, 1, 3]
2021-04-01 10:16:27,089 - 	 28.69386 0.00030
2021-04-01 10:17:30,747 - 
 ---------------------- mean loss : 29.66455  ---------------------- 

2021-04-01 10:17:30,748 - Starting Validation
2021-04-01 10:17:45,539 - 
                     ------- validation -------            

2021-04-01 10:17:45,540 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:17:45,540 - 	 5.5041  	 0.2400  	 0.1327 	 0.4892
2021-04-01 10:17:45,540 - -------------------------------
Validation Epoch: 1 	Accuracy: 13.0000	Loss: 377.053240
------------------
2021-04-01 10:17:45,542 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44_AT/dim12_out12_lr_0.0003_bs256_future_sgd_cos_t0.07-2021-04-01_10_16_10-model_best.pth

2021-04-01 10:17:45,542 - Best model updated in 'dim12_out12_lr_0.0003_bs256_future_sgd_cos_t0.07.ini'! !!!!!!!!!
2021-04-01 10:17:45,542 - #### End epoch 1/1000, elapsed time: 94.1362343300134
2021-04-01 10:17:45,542 - 
 --------------------------- epoch 2 ------------------------- 

2021-04-01 10:17:45,542 - weights are [1, 1, 1, 3]
2021-04-01 10:18:01,327 - 	 28.62191 0.00030
2021-04-01 10:19:09,154 - 
 ---------------------- mean loss : 29.65977  ---------------------- 

2021-04-01 10:19:09,154 - Starting Validation
2021-04-01 10:19:23,732 - 
                     ------- validation -------            

2021-04-01 10:19:23,732 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:19:23,732 - 	 5.5041  	 0.2393  	 0.1308 	 0.4890
2021-04-01 10:19:23,732 - -------------------------------
Validation Epoch: 2 	Accuracy: 13.0000	Loss: 376.988253
------------------
2021-04-01 10:19:23,733 - #### End epoch 2/1000, elapsed time: 98.19048847444355
2021-04-01 10:19:23,733 - 
 --------------------------- epoch 3 ------------------------- 

2021-04-01 10:19:23,733 - weights are [1, 1, 1, 3]
2021-04-01 10:19:37,297 - 	 28.59870 0.00030
2021-04-01 10:20:45,307 - 
 ---------------------- mean loss : 29.65348  ---------------------- 

2021-04-01 10:20:45,307 - Starting Validation
2021-04-01 10:21:00,288 - 
                     ------- validation -------            

2021-04-01 10:21:00,288 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:21:00,288 - 	 5.5041  	 0.2386  	 0.1290 	 0.4887
2021-04-01 10:21:00,288 - -------------------------------
Validation Epoch: 3 	Accuracy: 13.0000	Loss: 376.926851
------------------
2021-04-01 10:21:00,289 - #### End epoch 3/1000, elapsed time: 96.55593820754439
2021-04-01 10:21:00,289 - 
 --------------------------- epoch 4 ------------------------- 

2021-04-01 10:21:00,289 - weights are [1, 1, 1, 3]
2021-04-01 10:21:10,511 - 	 28.55719 0.00030
2021-04-01 10:22:22,037 - 
 ---------------------- mean loss : 29.64917  ---------------------- 

2021-04-01 10:22:22,037 - Starting Validation
2021-04-01 10:22:37,664 - 
                     ------- validation -------            

2021-04-01 10:22:37,664 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:22:37,664 - 	 5.5041  	 0.2379  	 0.1274 	 0.4885
2021-04-01 10:22:37,664 - -------------------------------
Validation Epoch: 4 	Accuracy: 13.0000	Loss: 376.868885
------------------
2021-04-01 10:22:37,665 - #### End epoch 4/1000, elapsed time: 97.37594841141254
2021-04-01 10:22:37,665 - 
 --------------------------- epoch 5 ------------------------- 

2021-04-01 10:22:37,665 - weights are [1, 1, 1, 3]
2021-04-01 10:22:53,265 - 	 32.90888 0.00030
2021-04-01 10:24:01,655 - 
 ---------------------- mean loss : 29.65011  ---------------------- 

2021-04-01 10:24:01,656 - Starting Validation
2021-04-01 10:24:16,189 - 
                     ------- validation -------            

2021-04-01 10:24:16,190 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:24:16,190 - 	 5.5041  	 0.2373  	 0.1258 	 0.4882
2021-04-01 10:24:16,190 - -------------------------------
Validation Epoch: 5 	Accuracy: 13.0000	Loss: 376.814062
------------------
2021-04-01 10:24:16,190 - #### End epoch 5/1000, elapsed time: 98.52536421641707
2021-04-01 10:24:16,190 - 
 --------------------------- epoch 6 ------------------------- 

2021-04-01 10:24:16,190 - weights are [1, 1, 1, 3]
2021-04-01 10:24:30,553 - 	 28.56474 0.00030
2021-04-01 10:25:35,483 - 
 ---------------------- mean loss : 29.64119  ---------------------- 

2021-04-01 10:25:35,483 - Starting Validation
2021-04-01 10:25:50,113 - 
                     ------- validation -------            

2021-04-01 10:25:50,113 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:25:50,114 - 	 5.5041  	 0.2367  	 0.1243 	 0.4880
2021-04-01 10:25:50,114 - -------------------------------
Validation Epoch: 6 	Accuracy: 14.0000	Loss: 376.762177
------------------
2021-04-01 10:25:50,117 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44_AT/dim12_out12_lr_0.0003_bs256_future_sgd_cos_t0.07-2021-04-01_10_16_10-model_best.pth

2021-04-01 10:25:50,117 - Best model updated in 'dim12_out12_lr_0.0003_bs256_future_sgd_cos_t0.07.ini'! !!!!!!!!!
2021-04-01 10:25:50,117 - #### End epoch 6/1000, elapsed time: 93.92744724173099
2021-04-01 10:25:50,118 - 
 --------------------------- epoch 7 ------------------------- 

2021-04-01 10:25:50,118 - weights are [1, 1, 1, 3]
2021-04-01 10:26:03,687 - 	 28.56088 0.00030
2021-04-01 10:27:12,284 - 
 ---------------------- mean loss : 29.63652  ---------------------- 

2021-04-01 10:27:12,285 - Starting Validation
2021-04-01 10:27:26,989 - 
                     ------- validation -------            

2021-04-01 10:27:26,989 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:27:26,989 - 	 5.5041  	 0.2361  	 0.1230 	 0.4878
2021-04-01 10:27:26,989 - -------------------------------
Validation Epoch: 7 	Accuracy: 13.0000	Loss: 376.712999
------------------
2021-04-01 10:27:26,992 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44_AT/dim12_out12_lr_0.0003_bs256_future_sgd_cos_t0.07-2021-04-01_10_16_10-model_best.pth

2021-04-01 10:27:26,992 - model got improved for this run, but did not surpass previous though, please take changes of hyper parameters into consideration
2021-04-01 10:27:26,992 - #### End epoch 7/1000, elapsed time: 96.87476225849241
2021-04-01 10:27:26,992 - 
 --------------------------- epoch 8 ------------------------- 

2021-04-01 10:27:26,993 - weights are [1, 1, 1, 3]
2021-04-01 10:27:39,805 - 	 28.54369 0.00030
2021-04-01 10:28:43,679 - 
 ---------------------- mean loss : 29.63311  ---------------------- 

2021-04-01 10:28:43,679 - Starting Validation
2021-04-01 10:28:58,175 - 
                     ------- validation -------            

2021-04-01 10:28:58,176 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:28:58,176 - 	 5.5041  	 0.2356  	 0.1217 	 0.4876
2021-04-01 10:28:58,176 - -------------------------------
Validation Epoch: 8 	Accuracy: 13.0000	Loss: 376.666357
------------------
2021-04-01 10:28:58,176 - #### End epoch 8/1000, elapsed time: 91.18359922152013
2021-04-01 10:28:58,176 - 
 --------------------------- epoch 9 ------------------------- 

2021-04-01 10:28:58,176 - weights are [1, 1, 1, 3]
2021-04-01 10:29:07,878 - 	 28.53813 0.00030
2021-04-01 10:30:20,175 - 
 ---------------------- mean loss : 29.63020  ---------------------- 

2021-04-01 10:30:20,175 - Starting Validation
2021-04-01 10:30:34,325 - 
                     ------- validation -------            

2021-04-01 10:30:34,325 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:30:34,326 - 	 5.5041  	 0.2350  	 0.1205 	 0.4874
2021-04-01 10:30:34,326 - -------------------------------
Validation Epoch: 9 	Accuracy: 13.0000	Loss: 376.622149
------------------
2021-04-01 10:30:34,326 - #### End epoch 9/1000, elapsed time: 96.1497670058161
2021-04-01 10:30:34,326 - 
 --------------------------- epoch 10 ------------------------- 

2021-04-01 10:30:34,326 - weights are [1, 1, 1, 3]
2021-04-01 10:30:45,462 - 	 28.58217 0.00030
2021-04-01 10:31:54,782 - 
 ---------------------- mean loss : 29.62692  ---------------------- 

2021-04-01 10:31:54,782 - Starting Validation
2021-04-01 10:32:09,650 - 
                     ------- validation -------            

2021-04-01 10:32:09,650 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:32:09,650 - 	 5.5041  	 0.2345  	 0.1193 	 0.4871
2021-04-01 10:32:09,650 - -------------------------------
Validation Epoch: 10 	Accuracy: 13.0000	Loss: 376.580091
------------------
2021-04-01 10:32:09,650 - #### End epoch 10/1000, elapsed time: 95.32462045922875
2021-04-01 10:32:09,651 - 
 --------------------------- epoch 11 ------------------------- 

2021-04-01 10:32:09,651 - weights are [1, 1, 1, 3]
2021-04-01 10:32:21,907 - 	 32.48348 0.00030
2021-04-01 10:33:32,723 - 
 ---------------------- mean loss : 29.63614  ---------------------- 

2021-04-01 10:33:32,724 - Starting Validation
2021-04-01 10:33:48,758 - 
                     ------- validation -------            

2021-04-01 10:33:48,759 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:33:48,759 - 	 5.5041  	 0.2340  	 0.1182 	 0.4869
2021-04-01 10:33:48,759 - -------------------------------
Validation Epoch: 11 	Accuracy: 13.0000	Loss: 376.540121
------------------
2021-04-01 10:33:48,759 - #### End epoch 11/1000, elapsed time: 99.10824814811349
2021-04-01 10:33:48,759 - 
 --------------------------- epoch 12 ------------------------- 

2021-04-01 10:33:48,759 - weights are [1, 1, 1, 3]
2021-04-01 10:34:01,329 - 	 28.51819 0.00030
2021-04-01 10:35:13,011 - 
 ---------------------- mean loss : 29.62042  ---------------------- 

2021-04-01 10:35:13,012 - Starting Validation
2021-04-01 10:35:27,857 - 
                     ------- validation -------            

2021-04-01 10:35:27,857 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:35:27,857 - 	 5.5041  	 0.2335  	 0.1172 	 0.4867
2021-04-01 10:35:27,857 - -------------------------------
Validation Epoch: 12 	Accuracy: 13.0000	Loss: 376.502060
------------------
2021-04-01 10:35:27,857 - #### End epoch 12/1000, elapsed time: 99.09867136459798
2021-04-01 10:35:27,858 - 
 --------------------------- epoch 13 ------------------------- 

2021-04-01 10:35:27,858 - weights are [1, 1, 1, 3]
2021-04-01 10:35:42,201 - 	 28.54219 0.00030
2021-04-01 10:36:46,688 - 
 ---------------------- mean loss : 29.61739  ---------------------- 

2021-04-01 10:36:46,689 - Starting Validation
2021-04-01 10:37:01,322 - 
                     ------- validation -------            

2021-04-01 10:37:01,323 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:37:01,323 - 	 5.5041  	 0.2330  	 0.1163 	 0.4865
2021-04-01 10:37:01,323 - -------------------------------
Validation Epoch: 13 	Accuracy: 13.0000	Loss: 376.465746
------------------
2021-04-01 10:37:01,323 - #### End epoch 13/1000, elapsed time: 93.46519176475704
2021-04-01 10:37:01,323 - 
 --------------------------- epoch 14 ------------------------- 

2021-04-01 10:37:01,323 - weights are [1, 1, 1, 3]
2021-04-01 10:37:13,584 - 	 28.54782 0.00030
2021-04-01 10:38:24,170 - 
 ---------------------- mean loss : 29.61555  ---------------------- 

2021-04-01 10:38:24,170 - Starting Validation
2021-04-01 10:38:42,165 - 
                     ------- validation -------            

2021-04-01 10:38:42,165 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:38:42,165 - 	 5.5041  	 0.2326  	 0.1153 	 0.4863
2021-04-01 10:38:42,165 - -------------------------------
Validation Epoch: 14 	Accuracy: 13.0000	Loss: 376.431139
------------------
2021-04-01 10:38:42,166 - #### End epoch 14/1000, elapsed time: 100.8427953645587
2021-04-01 10:38:42,166 - 
 --------------------------- epoch 15 ------------------------- 

2021-04-01 10:38:42,166 - weights are [1, 1, 1, 3]
2021-04-01 10:38:56,635 - 	 28.57688 0.00030
2021-04-01 10:40:03,134 - 
 ---------------------- mean loss : 29.61316  ---------------------- 

2021-04-01 10:40:03,137 - Starting Validation
2021-04-01 10:40:17,825 - 
                     ------- validation -------            

2021-04-01 10:40:17,826 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:40:17,826 - 	 5.5041  	 0.2321  	 0.1145 	 0.4861
2021-04-01 10:40:17,826 - -------------------------------
Validation Epoch: 15 	Accuracy: 13.0000	Loss: 376.398106
------------------
2021-04-01 10:40:17,826 - #### End epoch 15/1000, elapsed time: 95.66023713257164
2021-04-01 10:40:17,826 - 
 --------------------------- epoch 16 ------------------------- 

2021-04-01 10:40:17,826 - weights are [1, 1, 1, 3]
