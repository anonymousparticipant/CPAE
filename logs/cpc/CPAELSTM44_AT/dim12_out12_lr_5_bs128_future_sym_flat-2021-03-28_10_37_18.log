2021-03-28 10:37:18,750 - ===> use benchmark strategy to split train, validation and eval dataset
2021-03-28 10:37:20,077 - ### Model summary below###
 CPAELSTM44_AT(
  (lstm1): LSTM(76, 12, batch_first=True)
  (lstm2): LSTM(12, 12, batch_first=True)
  (lstm3): LSTM(12, 12, batch_first=True)
  (dropout): Dropout(p=0.3, inplace=False)
  (softmax): Softmax(dim=0)
  (lsoftmax): LogSoftmax()
  (fcs): Sequential(
    (0): Linear(in_features=12, out_features=12, bias=True)
    (1): ReLU(inplace=True)
    (2): Linear(in_features=12, out_features=12, bias=True)
  )
  (lstm4): LSTM(12, 76, batch_first=True)
  (att1): Linear(in_features=12, out_features=12, bias=True)
  (att2): Linear(in_features=12, out_features=12, bias=True)
  (W_pred): Linear(in_features=12, out_features=12, bias=True)
)

2021-03-28 10:37:20,077 - ===> Model total parameter: 34956

2021-03-28 10:37:20,077 - {'data_split': 'benchmark', 'batch_size': 128, 'mode': 0, 'dim': 12, 'bn': False, 'dropout': 0.3, 'task': 'ihm', 'learning_rate': 5, 'epochs': 1000, 'seed': 1, 'log_interval': 30, 'num_workers': 30, 'gru_out': 12, 'optimizer': 'ScheduledOptim(optim.Adam(filter(lambda p: p.requires_grad, model.parameters()), betas=(0.9, 0.98), eps=1e-09, weight_decay=1e-4, amsgrad=True),n_warmup_steps=20)', 'setting_name': 'dim12_out12_lr_5_bs128_future_sym_flat', 'run_name': 'dim12_out12_lr_5_bs128_future_sym_flat-2021-03-28_10_37_18', 'model_type': 'CPAELSTM44_AT', 'resume': False, 'model_best': 'dim12_out12_lr_0.15_bs128_future_flat-2021-03-28_10_14_35-model_best.pth', 'save_every': 100, 'lambda': [1, 1, 1, 3], 'time_step': 5, 'sym': True, 'flat_attention': True, 'top_path': '/home/shuying/CPAE/', 'scr_data_path': '/home/shuying/cpcSurvival/data', 'logging_dir': '/home/shuying/CPAE/logs/cpc/CPAELSTM44_AT', 'ini_file': '/home/shuying/CPAE/logs/cpc/CPAELSTM44_AT/dim12_out12_lr_5_bs128_future_sym_flat.ini', 'pred_mode': 'future', 't_range': (0.5, 0.7)}
2021-03-28 10:37:20,077 - 
 --------------------------- epoch 1 ------------------------- 

2021-03-28 10:37:20,077 - weights are [1, 1, 1, 3]
2021-03-28 10:37:26,576 - 	 25.14509 0.00099
2021-03-28 10:38:12,403 - 
 ---------------------- mean loss : 26.16725  ---------------------- 

2021-03-28 10:38:12,404 - Starting Validation
2021-03-28 10:38:25,659 - 
                     ------- validation -------            

2021-03-28 10:38:25,659 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-03-28 10:38:25,659 - 	 4.7835  	 0.1993  	 0.0989 	 0.4323
2021-03-28 10:38:25,659 - -------------------------------
Validation Epoch: 1 	Accuracy: 48.0000	Loss: 654.658291
------------------
2021-03-28 10:38:25,662 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44_AT/dim12_out12_lr_5_bs128_future_sym_flat-2021-03-28_10_37_18-model_best.pth

2021-03-28 10:38:25,670 - Best model updated in 'dim12_out12_lr_5_bs128_future_sym_flat.ini'! !!!!!!!!!
2021-03-28 10:38:25,674 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44_AT/dim12_out12_lr_5_bs128_future_sym_flat-2021-03-28_10_37_18-model_best.pth

2021-03-28 10:38:25,674 - model got improved for this run, but did not surpass previous though, please take changes of hyper parameters into consideration
2021-03-28 10:38:25,674 - #### End epoch 1/1000, elapsed time: 65.5971267032437
2021-03-28 10:38:25,674 - 
 --------------------------- epoch 2 ------------------------- 

2021-03-28 10:38:25,674 - weights are [1, 1, 1, 3]
2021-03-28 10:38:32,151 - 	 24.89759 0.00296
2021-03-28 10:39:12,874 - 	 21.73641 0.00395
2021-03-28 10:39:17,941 - 
 ---------------------- mean loss : 23.70606  ---------------------- 

2021-03-28 10:39:17,941 - Starting Validation
2021-03-28 10:39:31,056 - 
                     ------- validation -------            

2021-03-28 10:39:31,056 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-03-28 10:39:31,056 - 	 4.1287  	 0.1793  	 0.0968 	 0.4100
2021-03-28 10:39:31,056 - -------------------------------
Validation Epoch: 2 	Accuracy: 52.0000	Loss: 567.747911
------------------
2021-03-28 10:39:31,059 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44_AT/dim12_out12_lr_5_bs128_future_sym_flat-2021-03-28_10_37_18-model_best.pth

2021-03-28 10:39:31,067 - Best model updated in 'dim12_out12_lr_5_bs128_future_sym_flat.ini'! !!!!!!!!!
2021-03-28 10:39:31,071 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44_AT/dim12_out12_lr_5_bs128_future_sym_flat-2021-03-28_10_37_18-model_best.pth

2021-03-28 10:39:31,071 - model got improved for this run, but did not surpass previous though, please take changes of hyper parameters into consideration
2021-03-28 10:39:31,071 - #### End epoch 2/1000, elapsed time: 65.3965031541884
2021-03-28 10:39:31,071 - 
 --------------------------- epoch 3 ------------------------- 

2021-03-28 10:39:31,071 - weights are [1, 1, 1, 3]
2021-03-28 10:39:38,070 - 	 21.94530 0.00494
2021-03-28 10:40:18,645 - 	 21.77390 0.00593
2021-03-28 10:40:23,693 - 
 ---------------------- mean loss : 22.68720  ---------------------- 

2021-03-28 10:40:23,693 - Starting Validation
2021-03-28 10:40:36,368 - 
                     ------- validation -------            

2021-03-28 10:40:36,368 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-03-28 10:40:36,368 - 	 4.1251  	 0.1717  	 0.0901 	 0.3981
2021-03-28 10:40:36,368 - -------------------------------
Validation Epoch: 3 	Accuracy: 52.0000	Loss: 566.120056
------------------
2021-03-28 10:40:36,368 - #### End epoch 3/1000, elapsed time: 65.29732068022713
2021-03-28 10:40:36,368 - 
 --------------------------- epoch 4 ------------------------- 

2021-03-28 10:40:36,368 - weights are [1, 1, 1, 3]
2021-03-28 10:40:43,417 - 	 21.51777 0.00692
2021-03-28 10:41:23,624 - 	 21.38720 0.00791
2021-03-28 10:41:28,573 - 
 ---------------------- mean loss : 22.58082  ---------------------- 

2021-03-28 10:41:28,574 - Starting Validation
2021-03-28 10:41:41,431 - 
                     ------- validation -------            

2021-03-28 10:41:41,431 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-03-28 10:41:41,431 - 	 4.1226  	 0.1589  	 0.0460 	 0.3927
2021-03-28 10:41:41,431 - -------------------------------
Validation Epoch: 4 	Accuracy: 52.0000	Loss: 562.882073
------------------
2021-03-28 10:41:41,431 - #### End epoch 4/1000, elapsed time: 65.06299749901518
2021-03-28 10:41:41,431 - 
 --------------------------- epoch 5 ------------------------- 

2021-03-28 10:41:41,431 - weights are [1, 1, 1, 3]
2021-03-28 10:41:49,674 - 	 22.09947 0.00889
2021-03-28 10:42:29,265 - 	 21.26971 0.00988
2021-03-28 10:42:34,256 - 
 ---------------------- mean loss : 22.50857  ---------------------- 

2021-03-28 10:42:34,257 - Starting Validation
2021-03-28 10:42:46,775 - 
                     ------- validation -------            

2021-03-28 10:42:46,775 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-03-28 10:42:46,775 - 	 4.1226  	 0.1552  	 0.0384 	 0.3877
2021-03-28 10:42:46,775 - -------------------------------
Validation Epoch: 5 	Accuracy: 52.0000	Loss: 562.132041
------------------
2021-03-28 10:42:46,775 - #### End epoch 5/1000, elapsed time: 65.34406260121614
2021-03-28 10:42:46,775 - 
 --------------------------- epoch 6 ------------------------- 

2021-03-28 10:42:46,775 - weights are [1, 1, 1, 3]
2021-03-28 10:42:54,264 - 	 21.24091 0.01087
2021-03-28 10:43:48,829 - 	 21.31355 0.01186
2021-03-28 10:43:57,133 - 
 ---------------------- mean loss : 22.47224  ---------------------- 

2021-03-28 10:43:57,133 - Starting Validation
2021-03-28 10:44:11,238 - 
                     ------- validation -------            

2021-03-28 10:44:11,239 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-03-28 10:44:11,239 - 	 4.1230  	 0.1512  	 0.0378 	 0.3823
2021-03-28 10:44:11,239 - -------------------------------
Validation Epoch: 6 	Accuracy: 52.0000	Loss: 561.771036
------------------
2021-03-28 10:44:11,239 - #### End epoch 6/1000, elapsed time: 84.46367179974914
2021-03-28 10:44:11,239 - 
 --------------------------- epoch 7 ------------------------- 

2021-03-28 10:44:11,239 - weights are [1, 1, 1, 3]
2021-03-28 10:44:18,956 - 	 21.18300 0.01383
2021-03-28 10:45:19,008 - 	 21.15788 0.01581
2021-03-28 10:45:26,539 - 
 ---------------------- mean loss : 22.45837  ---------------------- 

2021-03-28 10:45:26,539 - Starting Validation
2021-03-28 10:45:40,725 - 
                     ------- validation -------            

2021-03-28 10:45:40,725 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-03-28 10:45:40,725 - 	 4.1214  	 0.1470  	 0.0370 	 0.3782
2021-03-28 10:45:40,725 - -------------------------------
Validation Epoch: 7 	Accuracy: 52.0000	Loss: 561.185607
------------------
2021-03-28 10:45:40,725 - #### End epoch 7/1000, elapsed time: 89.4861504570581
2021-03-28 10:45:40,725 - 
 --------------------------- epoch 8 ------------------------- 

2021-03-28 10:45:40,725 - weights are [1, 1, 1, 3]
2021-03-28 10:45:48,817 - 	 21.30483 0.01779
2021-03-28 10:46:48,830 - 	 21.33202 0.01976
2021-03-28 10:46:56,609 - 
 ---------------------- mean loss : 22.44596  ---------------------- 

2021-03-28 10:46:56,610 - Starting Validation
2021-03-28 10:47:11,066 - 
                     ------- validation -------            

2021-03-28 10:47:11,066 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-03-28 10:47:11,066 - 	 4.1215  	 0.1452  	 0.0369 	 0.3737
2021-03-28 10:47:11,066 - -------------------------------
Validation Epoch: 8 	Accuracy: 52.0000	Loss: 560.926156
------------------
2021-03-28 10:47:11,066 - #### End epoch 8/1000, elapsed time: 90.3412700346671
2021-03-28 10:47:11,067 - 
 --------------------------- epoch 9 ------------------------- 

2021-03-28 10:47:11,067 - weights are [1, 1, 1, 3]
2021-03-28 10:47:16,581 - 	 25.82605 0.01884
2021-03-28 10:48:16,599 - 	 21.29027 0.01804
2021-03-28 10:48:23,955 - 
 ---------------------- mean loss : 22.46695  ---------------------- 

2021-03-28 10:48:23,956 - Starting Validation
2021-03-28 10:48:38,054 - 
                     ------- validation -------            

2021-03-28 10:48:38,054 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-03-28 10:48:38,055 - 	 4.1219  	 0.1427  	 0.0357 	 0.3713
2021-03-28 10:48:38,055 - -------------------------------
Validation Epoch: 9 	Accuracy: 52.0000	Loss: 560.718913
------------------
2021-03-28 10:48:38,055 - #### End epoch 9/1000, elapsed time: 86.9889612570405
2021-03-28 10:48:38,056 - 
 --------------------------- epoch 10 ------------------------- 

2021-03-28 10:48:38,056 - weights are [1, 1, 1, 3]
2021-03-28 10:48:43,896 - 	 21.21145 0.01733
2021-03-28 10:49:44,214 - 	 21.19154 0.01670
2021-03-28 10:49:52,288 - 
 ---------------------- mean loss : 22.43529  ---------------------- 

2021-03-28 10:49:52,289 - Starting Validation
2021-03-28 10:50:06,476 - 
                     ------- validation -------            

2021-03-28 10:50:06,476 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-03-28 10:50:06,477 - 	 4.1216  	 0.1395  	 0.0352 	 0.3671
2021-03-28 10:50:06,477 - -------------------------------
Validation Epoch: 10 	Accuracy: 52.0000	Loss: 560.354556
------------------
2021-03-28 10:50:06,477 - #### End epoch 10/1000, elapsed time: 88.42112456029281
2021-03-28 10:50:06,477 - 
 --------------------------- epoch 11 ------------------------- 

2021-03-28 10:50:06,477 - weights are [1, 1, 1, 3]
2021-03-28 10:50:14,367 - 	 25.57755 0.01563
