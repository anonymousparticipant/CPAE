2021-03-28 10:43:11,054 - ===> use benchmark strategy to split train, validation and eval dataset
2021-03-28 10:43:12,416 - ### Model summary below###
 CPAELSTM44_AT(
  (lstm1): LSTM(76, 12, batch_first=True)
  (lstm2): LSTM(12, 12, batch_first=True)
  (lstm3): LSTM(12, 12, batch_first=True)
  (dropout): Dropout(p=0.3, inplace=False)
  (softmax): Softmax(dim=0)
  (lsoftmax): LogSoftmax()
  (fcs): Sequential(
    (0): Linear(in_features=12, out_features=12, bias=True)
    (1): ReLU(inplace=True)
    (2): Linear(in_features=12, out_features=12, bias=True)
  )
  (lstm4): LSTM(12, 76, batch_first=True)
  (att1): Linear(in_features=12, out_features=12, bias=True)
  (att2): Linear(in_features=12, out_features=12, bias=True)
  (W_pred): Linear(in_features=12, out_features=12, bias=True)
)

2021-03-28 10:43:12,416 - ===> Model total parameter: 34956

2021-03-28 10:43:12,416 - {'data_split': 'benchmark', 'batch_size': 128, 'mode': 0, 'dim': 12, 'bn': False, 'dropout': 0.3, 'task': 'ihm', 'learning_rate': 100, 'epochs': 1000, 'seed': 1, 'log_interval': 30, 'num_workers': 30, 'gru_out': 12, 'optimizer': 'ScheduledOptim(optim.Adam(filter(lambda p: p.requires_grad, model.parameters()), betas=(0.9, 0.98), eps=1e-09, weight_decay=1e-4, amsgrad=True),n_warmup_steps=20)', 'setting_name': 'dim12_out12_lr_100_bs128_future_sym_flat', 'run_name': 'dim12_out12_lr_100_bs128_future_sym_flat-2021-03-28_10_43_11', 'model_type': 'CPAELSTM44_AT', 'resume': False, 'model_best': 'dim12_out12_lr_5_bs128_future_sym_flat-2021-03-28_10_37_18-model_best.pth', 'save_every': 100, 'lambda': [1, 1, 1, 3], 'time_step': 5, 'sym': True, 'flat_attention': True, 'top_path': '/home/shuying/CPAE/', 'scr_data_path': '/home/shuying/cpcSurvival/data', 'logging_dir': '/home/shuying/CPAE/logs/cpc/CPAELSTM44_AT', 'ini_file': '/home/shuying/CPAE/logs/cpc/CPAELSTM44_AT/dim12_out12_lr_100_bs128_future_sym_flat.ini', 'pred_mode': 'future', 't_range': (0.5, 0.7)}
2021-03-28 10:43:12,416 - 
 --------------------------- epoch 1 ------------------------- 

2021-03-28 10:43:12,416 - weights are [1, 1, 1, 3]
2021-03-28 10:43:17,053 - 	 25.11678 0.00099
2021-03-28 10:44:19,160 - 	 24.93978 0.00198
2021-03-28 10:44:26,632 - 
 ---------------------- mean loss : 26.06629  ---------------------- 

2021-03-28 10:44:26,633 - Starting Validation
2021-03-28 10:44:41,038 - 
                     ------- validation -------            

2021-03-28 10:44:41,038 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-03-28 10:44:41,038 - 	 4.3147  	 0.1979  	 0.0991 	 0.4497
2021-03-28 10:44:41,038 - -------------------------------
Validation Epoch: 1 	Accuracy: 52.0000	Loss: 594.592101
------------------
2021-03-28 10:44:41,042 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44_AT/dim12_out12_lr_100_bs128_future_sym_flat-2021-03-28_10_43_11-model_best.pth

2021-03-28 10:44:41,043 - Best model updated in 'dim12_out12_lr_100_bs128_future_sym_flat.ini'! !!!!!!!!!
2021-03-28 10:44:41,047 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44_AT/dim12_out12_lr_100_bs128_future_sym_flat-2021-03-28_10_43_11-model_best.pth

2021-03-28 10:44:41,047 - model got improved for this run, but did not surpass previous though, please take changes of hyper parameters into consideration
2021-03-28 10:44:41,047 - #### End epoch 1/1000, elapsed time: 88.63124473905191
2021-03-28 10:44:41,047 - 
 --------------------------- epoch 2 ------------------------- 

2021-03-28 10:44:41,047 - weights are [1, 1, 1, 3]
2021-03-28 10:44:45,803 - 	 22.63970 0.00296
2021-03-28 10:45:45,068 - 	 21.53784 0.00395
2021-03-28 10:45:52,696 - 
 ---------------------- mean loss : 22.80585  ---------------------- 

2021-03-28 10:45:52,697 - Starting Validation
2021-03-28 10:46:06,850 - 
                     ------- validation -------            

2021-03-28 10:46:06,850 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-03-28 10:46:06,850 - 	 4.1252  	 0.1823  	 0.0977 	 0.4213
2021-03-28 10:46:06,850 - -------------------------------
Validation Epoch: 2 	Accuracy: 52.0000	Loss: 568.002053
------------------
2021-03-28 10:46:06,850 - #### End epoch 2/1000, elapsed time: 85.80307350307703
2021-03-28 10:46:06,850 - 
 --------------------------- epoch 3 ------------------------- 

2021-03-28 10:46:06,850 - weights are [1, 1, 1, 3]
2021-03-28 10:46:13,058 - 	 21.52999 0.00494
2021-03-28 10:47:11,895 - 	 45.78010 0.00593
2021-03-28 10:47:21,229 - 
 ---------------------- mean loss : 22.67884  ---------------------- 

2021-03-28 10:47:21,230 - Starting Validation
2021-03-28 10:47:35,599 - 
                     ------- validation -------            

2021-03-28 10:47:35,600 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-03-28 10:47:35,600 - 	 4.1239  	 0.1761  	 0.0964 	 0.4061
2021-03-28 10:47:35,600 - -------------------------------
Validation Epoch: 3 	Accuracy: 52.0000	Loss: 566.810965
------------------
2021-03-28 10:47:35,600 - #### End epoch 3/1000, elapsed time: 88.74968036124483
2021-03-28 10:47:35,600 - 
 --------------------------- epoch 4 ------------------------- 

2021-03-28 10:47:35,600 - weights are [1, 1, 1, 3]
2021-03-28 10:47:42,800 - 	 21.43131 0.00692
2021-03-28 10:48:40,102 - 	 21.47366 0.00791
2021-03-28 10:48:48,971 - 
 ---------------------- mean loss : 22.64008  ---------------------- 

2021-03-28 10:48:48,972 - Starting Validation
2021-03-28 10:49:03,269 - 
                     ------- validation -------            

2021-03-28 10:49:03,269 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-03-28 10:49:03,269 - 	 4.1239  	 0.1741  	 0.0928 	 0.3978
2021-03-28 10:49:03,269 - -------------------------------
Validation Epoch: 4 	Accuracy: 52.0000	Loss: 566.146600
------------------
2021-03-28 10:49:03,270 - #### End epoch 4/1000, elapsed time: 87.66951796319336
2021-03-28 10:49:03,270 - 
 --------------------------- epoch 5 ------------------------- 

2021-03-28 10:49:03,270 - weights are [1, 1, 1, 3]
2021-03-28 10:49:11,578 - 	 21.43362 0.00889
2021-03-28 10:50:09,399 - 	 23.25891 0.00988
2021-03-28 10:50:18,050 - 
 ---------------------- mean loss : 22.60083  ---------------------- 

2021-03-28 10:50:18,051 - Starting Validation
2021-03-28 10:50:32,435 - 
                     ------- validation -------            

2021-03-28 10:50:32,435 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-03-28 10:50:32,435 - 	 4.1252  	 0.1650  	 0.0722 	 0.3942
2021-03-28 10:50:32,435 - -------------------------------
Validation Epoch: 5 	Accuracy: 52.0000	Loss: 564.819074
------------------
2021-03-28 10:50:32,435 - #### End epoch 5/1000, elapsed time: 89.16564152995124
2021-03-28 10:50:32,435 - 
 --------------------------- epoch 6 ------------------------- 

2021-03-28 10:50:32,435 - weights are [1, 1, 1, 3]
2021-03-28 10:50:37,652 - 	 24.11917 0.01186
