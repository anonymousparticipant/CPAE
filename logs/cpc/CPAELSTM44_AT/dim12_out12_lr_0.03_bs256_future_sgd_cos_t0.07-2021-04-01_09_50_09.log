2021-04-01 09:50:09,949 - ===> use benchmark strategy to split train, validation and eval dataset
2021-04-01 09:50:11,452 - ### Model summary below###
 CPAELSTM44_AT(
  (lstm1): LSTM(76, 12, batch_first=True)
  (lstm2): LSTM(12, 12, batch_first=True)
  (lstm3): LSTM(12, 12, batch_first=True)
  (dropout): Dropout(p=0.3, inplace=False)
  (softmax): Softmax(dim=0)
  (lsoftmax): LogSoftmax()
  (fcs): Sequential(
    (0): Linear(in_features=12, out_features=12, bias=True)
    (1): ReLU(inplace=True)
    (2): Linear(in_features=12, out_features=12, bias=True)
  )
  (lstm4): LSTM(12, 76, batch_first=True)
  (att1): Linear(in_features=12, out_features=12, bias=True)
  (att2): Linear(in_features=12, out_features=12, bias=True)
  (W_pred): Linear(in_features=12, out_features=12, bias=True)
)

2021-04-01 09:50:11,452 - ===> Model total parameter: 34956

2021-04-01 09:50:11,452 - {'data_split': 'benchmark', 'batch_size': 256, 'mode': 0, 'dim': 12, 'bn': False, 'dropout': 0.3, 'task': 'ihm', 'learning_rate': 0.03, 'epochs': 1000, 'seed': 1, 'log_interval': 5, 'num_workers': 30, 'gru_out': 12, 'sim': 'cosine', 'temperature': 0.07, 'optimizer': 'optim.SGD(filter(lambda p: p.requires_grad,model.parameters()), lr=0.03, momentum=0.9, weight_decay=1e-4)', 'adjust_lr': True, 'setting_name': 'dim12_out12_lr_0.03_bs256_future_sgd_cos_t0.07', 'run_name': 'dim12_out12_lr_0.03_bs256_future_sgd_cos_t0.07-2021-04-01_09_50_09', 'model_type': 'CPAELSTM44_AT', 'resume': False, 'model_best': 'dim12_out12_lr_0.03_bs256_future_sgd_cos_t0.07-2021-04-01_09_39_58-model_best.pth', 'save_every': 100, 'lambda': [1, 1, 1, 3], 'time_step': 30, 'sym': False, 'top_path': '/home/shuying/CPAE/', 'scr_data_path': '/home/shuying/cpcSurvival/data', 'logging_dir': '/home/shuying/CPAE/logs/cpc/CPAELSTM44_AT', 'ini_file': '/home/shuying/CPAE/logs/cpc/CPAELSTM44_AT/dim12_out12_lr_0.03_bs256_future_sgd_cos_t0.07.ini', 'updated_lr': 0.03, 'pred_mode': 'future', 't_range': (0.5, 0.7)}
2021-04-01 09:50:11,452 - 
 --------------------------- epoch 1 ------------------------- 

2021-04-01 09:50:11,452 - weights are [1, 1, 1, 3]
2021-04-01 09:50:20,599 - 	 28.67749 0.03000
2021-04-01 09:51:06,238 - 
 ---------------------- mean loss : 29.58928  ---------------------- 

2021-04-01 09:51:06,239 - Starting Validation
2021-04-01 09:51:19,264 - 
                     ------- validation -------            

2021-04-01 09:51:19,264 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:51:19,264 - 	 5.5041  	 0.2174  	 0.0987 	 0.4774
2021-04-01 09:51:19,264 - -------------------------------
Validation Epoch: 1 	Accuracy: 14.0000	Loss: 375.567951
------------------
2021-04-01 09:51:19,275 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44_AT/dim12_out12_lr_0.03_bs256_future_sgd_cos_t0.07-2021-04-01_09_50_09-model_best.pth

2021-04-01 09:51:19,276 - Best model updated in 'dim12_out12_lr_0.03_bs256_future_sgd_cos_t0.07.ini'! !!!!!!!!!
2021-04-01 09:51:19,276 - #### End epoch 1/1000, elapsed time: 67.82402922585607
2021-04-01 09:51:19,276 - 
 --------------------------- epoch 2 ------------------------- 

2021-04-01 09:51:19,276 - weights are [1, 1, 1, 3]
2021-04-01 09:51:32,354 - 	 28.44630 0.03000
2021-04-01 09:52:42,485 - 
 ---------------------- mean loss : 29.53777  ---------------------- 

2021-04-01 09:52:42,485 - Starting Validation
2021-04-01 09:52:57,926 - 
                     ------- validation -------            

2021-04-01 09:52:57,926 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:52:57,926 - 	 5.5041  	 0.2115  	 0.0984 	 0.4727
2021-04-01 09:52:57,926 - -------------------------------
Validation Epoch: 2 	Accuracy: 15.0000	Loss: 375.360285
------------------
2021-04-01 09:52:57,928 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44_AT/dim12_out12_lr_0.03_bs256_future_sgd_cos_t0.07-2021-04-01_09_50_09-model_best.pth

2021-04-01 09:52:57,929 - Best model updated in 'dim12_out12_lr_0.03_bs256_future_sgd_cos_t0.07.ini'! !!!!!!!!!
2021-04-01 09:52:57,929 - #### End epoch 2/1000, elapsed time: 98.65281981881708
2021-04-01 09:52:57,929 - 
 --------------------------- epoch 3 ------------------------- 

2021-04-01 09:52:57,929 - weights are [1, 1, 1, 3]
2021-04-01 09:53:12,213 - 	 28.60266 0.03000
2021-04-01 09:54:18,979 - 
 ---------------------- mean loss : 29.52681  ---------------------- 

2021-04-01 09:54:18,979 - Starting Validation
2021-04-01 09:54:33,625 - 
                     ------- validation -------            

2021-04-01 09:54:33,625 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:54:33,625 - 	 5.5041  	 0.2087  	 0.0983 	 0.4693
2021-04-01 09:54:33,625 - -------------------------------
Validation Epoch: 3 	Accuracy: 16.0000	Loss: 375.234224
------------------
2021-04-01 09:54:33,628 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44_AT/dim12_out12_lr_0.03_bs256_future_sgd_cos_t0.07-2021-04-01_09_50_09-model_best.pth

2021-04-01 09:54:33,628 - Best model updated in 'dim12_out12_lr_0.03_bs256_future_sgd_cos_t0.07.ini'! !!!!!!!!!
2021-04-01 09:54:33,628 - #### End epoch 3/1000, elapsed time: 95.69938188884407
2021-04-01 09:54:33,628 - 
 --------------------------- epoch 4 ------------------------- 

2021-04-01 09:54:33,628 - weights are [1, 1, 1, 3]
2021-04-01 09:54:48,018 - 	 30.78381 0.03000
2021-04-01 09:55:57,366 - 
 ---------------------- mean loss : 29.51381  ---------------------- 

2021-04-01 09:55:57,366 - Starting Validation
2021-04-01 09:56:10,648 - 
                     ------- validation -------            

2021-04-01 09:56:10,648 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:56:10,648 - 	 5.5041  	 0.2051  	 0.0983 	 0.4581
2021-04-01 09:56:10,648 - -------------------------------
Validation Epoch: 4 	Accuracy: 16.0000	Loss: 374.896732
------------------
2021-04-01 09:56:10,648 - #### End epoch 4/1000, elapsed time: 97.02025615330786
2021-04-01 09:56:10,649 - 
 --------------------------- epoch 5 ------------------------- 

2021-04-01 09:56:10,649 - weights are [1, 1, 1, 3]
2021-04-01 09:56:20,463 - 	 28.40508 0.03000
2021-04-01 09:57:05,313 - 
 ---------------------- mean loss : 29.46480  ---------------------- 

2021-04-01 09:57:05,314 - Starting Validation
2021-04-01 09:57:18,970 - 
                     ------- validation -------            

2021-04-01 09:57:18,970 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:57:18,970 - 	 5.5041  	 0.1988  	 0.0983 	 0.4333
2021-04-01 09:57:18,970 - -------------------------------
Validation Epoch: 5 	Accuracy: 15.0000	Loss: 374.170263
------------------
2021-04-01 09:57:18,975 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44_AT/dim12_out12_lr_0.03_bs256_future_sgd_cos_t0.07-2021-04-01_09_50_09-model_best.pth

2021-04-01 09:57:18,975 - model got improved for this run, but did not surpass previous though, please take changes of hyper parameters into consideration
2021-04-01 09:57:18,975 - #### End epoch 5/1000, elapsed time: 68.32670386694372
2021-04-01 09:57:18,976 - 
 --------------------------- epoch 6 ------------------------- 

2021-04-01 09:57:18,976 - weights are [1, 1, 1, 3]
2021-04-01 09:57:31,395 - 	 28.52808 0.03000
2021-04-01 09:58:27,694 - 
 ---------------------- mean loss : 29.41952  ---------------------- 

2021-04-01 09:58:27,695 - Starting Validation
2021-04-01 09:58:42,513 - 
                     ------- validation -------            

2021-04-01 09:58:42,513 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 09:58:42,513 - 	 5.5041  	 0.1935  	 0.0984 	 0.4131
2021-04-01 09:58:42,514 - -------------------------------
Validation Epoch: 6 	Accuracy: 15.0000	Loss: 373.578018
------------------
2021-04-01 09:58:42,514 - #### End epoch 6/1000, elapsed time: 83.53831681236625
2021-04-01 09:58:42,514 - 
 --------------------------- epoch 7 ------------------------- 

2021-04-01 09:58:42,514 - weights are [1, 1, 1, 3]
2021-04-01 09:58:59,699 - 	 30.62302 0.03000
2021-04-01 10:00:35,584 - 
 ---------------------- mean loss : 29.39363  ---------------------- 

2021-04-01 10:00:35,584 - Starting Validation
2021-04-01 10:00:52,030 - 
                     ------- validation -------            

2021-04-01 10:00:52,030 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:00:52,030 - 	 5.5041  	 0.1921  	 0.0980 	 0.4089
2021-04-01 10:00:52,030 - -------------------------------
Validation Epoch: 7 	Accuracy: 12.0000	Loss: 373.441515
------------------
2021-04-01 10:00:52,030 - #### End epoch 7/1000, elapsed time: 129.51642095576972
2021-04-01 10:00:52,030 - 
 --------------------------- epoch 8 ------------------------- 

2021-04-01 10:00:52,030 - weights are [1, 1, 1, 3]
2021-04-01 10:01:08,899 - 	 28.60141 0.03000
2021-04-01 10:02:41,047 - 
 ---------------------- mean loss : 29.45587  ---------------------- 

2021-04-01 10:02:41,047 - Starting Validation
2021-04-01 10:02:57,814 - 
                     ------- validation -------            

2021-04-01 10:02:57,814 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:02:57,814 - 	 5.5041  	 0.1910  	 0.0977 	 0.4060
2021-04-01 10:02:57,814 - -------------------------------
Validation Epoch: 8 	Accuracy: 15.0000	Loss: 373.344748
------------------
2021-04-01 10:02:57,814 - #### End epoch 8/1000, elapsed time: 125.7839217344299
2021-04-01 10:02:57,814 - 
 --------------------------- epoch 9 ------------------------- 

2021-04-01 10:02:57,814 - weights are [1, 1, 1, 3]
2021-04-01 10:03:14,551 - 	 28.33551 0.03000
2021-04-01 10:04:48,472 - 
 ---------------------- mean loss : 29.38003  ---------------------- 

2021-04-01 10:04:48,472 - Starting Validation
2021-04-01 10:05:05,243 - 
                     ------- validation -------            

2021-04-01 10:05:05,243 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:05:05,243 - 	 5.5041  	 0.1901  	 0.0974 	 0.4037
2021-04-01 10:05:05,243 - -------------------------------
Validation Epoch: 9 	Accuracy: 14.0000	Loss: 373.265659
------------------
2021-04-01 10:05:05,243 - #### End epoch 9/1000, elapsed time: 127.42877734079957
2021-04-01 10:05:05,243 - 
 --------------------------- epoch 10 ------------------------- 

2021-04-01 10:05:05,243 - weights are [1, 1, 1, 3]
2021-04-01 10:05:21,849 - 	 28.27983 0.03000
2021-04-01 10:06:48,516 - 
 ---------------------- mean loss : 29.37460  ---------------------- 

2021-04-01 10:06:48,516 - Starting Validation
2021-04-01 10:07:03,378 - 
                     ------- validation -------            

2021-04-01 10:07:03,378 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:07:03,378 - 	 5.5041  	 0.1891  	 0.0970 	 0.4015
2021-04-01 10:07:03,378 - -------------------------------
Validation Epoch: 10 	Accuracy: 17.0000	Loss: 373.185169
------------------
2021-04-01 10:07:03,382 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44_AT/dim12_out12_lr_0.03_bs256_future_sgd_cos_t0.07-2021-04-01_09_50_09-model_best.pth

2021-04-01 10:07:03,382 - Best model updated in 'dim12_out12_lr_0.03_bs256_future_sgd_cos_t0.07.ini'! !!!!!!!!!
2021-04-01 10:07:03,382 - #### End epoch 10/1000, elapsed time: 118.13949140906334
2021-04-01 10:07:03,383 - 
 --------------------------- epoch 11 ------------------------- 

2021-04-01 10:07:03,383 - weights are [1, 1, 1, 3]
2021-04-01 10:07:17,883 - 	 28.30510 0.03000
2021-04-01 10:08:18,497 - 
 ---------------------- mean loss : 29.36984  ---------------------- 

2021-04-01 10:08:18,503 - Starting Validation
2021-04-01 10:08:33,292 - 
                     ------- validation -------            

2021-04-01 10:08:33,292 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:08:33,292 - 	 5.5041  	 0.1879  	 0.0965 	 0.3995
2021-04-01 10:08:33,292 - -------------------------------
Validation Epoch: 11 	Accuracy: 14.0000	Loss: 373.101728
------------------
2021-04-01 10:08:33,292 - #### End epoch 11/1000, elapsed time: 89.90965931117535
2021-04-01 10:08:33,292 - 
 --------------------------- epoch 12 ------------------------- 

2021-04-01 10:08:33,292 - weights are [1, 1, 1, 3]
2021-04-01 10:08:44,184 - 	 28.43499 0.03000
2021-04-01 10:09:53,127 - 
 ---------------------- mean loss : 29.36393  ---------------------- 

2021-04-01 10:09:53,127 - Starting Validation
2021-04-01 10:10:07,988 - 
                     ------- validation -------            

2021-04-01 10:10:07,988 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 10:10:07,988 - 	 5.5041  	 0.1860  	 0.0957 	 0.3967
2021-04-01 10:10:07,988 - -------------------------------
Validation Epoch: 12 	Accuracy: 14.0000	Loss: 372.984623
------------------
2021-04-01 10:10:07,988 - #### End epoch 12/1000, elapsed time: 94.69571001268923
2021-04-01 10:10:07,988 - 
 --------------------------- epoch 13 ------------------------- 

2021-04-01 10:10:07,988 - weights are [1, 1, 1, 3]
2021-04-01 10:10:22,049 - 	 28.28220 0.03000
2021-04-01 10:11:30,718 - 
 ---------------------- mean loss : 29.36049  ---------------------- 

2021-04-01 10:11:30,718 - Starting Validation
